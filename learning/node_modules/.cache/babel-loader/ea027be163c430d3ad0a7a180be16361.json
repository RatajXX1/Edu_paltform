{"ast":null,"code":"var _jsxFileName = \"/Users/michalratajewski/edupage/files/learning/src/windows/CreateLesson.js\";\nimport React, { memo, useMemo } from \"react\";\nimport '../styles/CreateLesson.css';\nimport Cropper from \"react-cropper\";\nimport 'cropperjs/dist/cropper.css';\nimport ReactQuill from \"react-quill\";\nimport 'react-quill/dist/quill.snow.css';\nimport Calendar_pop from \"./calendar_pop\";\nimport ShareLesson from \"./ShareLesson\";\nimport * as mime from 'react-native-mime-types';\nimport serverPath from \"../utilis/server-path\";\nimport loading_lesson from '../images/loading_lesson.svg';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class CreateLesson extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      UrlPath: 'skopiowane',\n      LoadingPop: true,\n      LessonCreated: true,\n      EditFile: false,\n      CalendarOpen: false,\n      BackgroundName: '',\n      AdditionalImages: [],\n      Content: {\n        Subject: '',\n        Image: '',\n        Desc: '',\n        Lesson: [{\n          Text: '',\n          Answer: 1,\n          Files: []\n        }],\n        EnableCode: 0,\n        Code: '',\n        CanExpire: 0,\n        Expire: new Date().toLocaleDateString(),\n        Users: [],\n        Groups: []\n      }\n    };\n    this.cropref = /*#__PURE__*/React.createRef();\n    this.modules = {\n      toolbar: {\n        container: [[{\n          'header': [1, 2, 3, 4, 5, 6, false]\n        }], ['bold', 'italic', 'underline'], [{\n          'list': 'ordered'\n        }, {\n          'list': 'bullet'\n        }], [{\n          'align': []\n        }], ['link', 'image'], ['clean'], [{\n          'color': []\n        }]] // handlers: {\n        //     image: this.imageHandler,\n        // },\n\n      }\n    };\n  }\n\n  CopyURL() {\n    navigator.clipboard.writeText();\n  }\n\n  CreatingLessonPop() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'CreateLesson_creatingpop',\n      children: [!this.state.LessonCreated && /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Tworzenie lekcji, prosze czeka\\u0107!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 47\n      }, this), !this.state.LessonCreated && /*#__PURE__*/_jsxDEV(\"img\", {\n        className: 'CreateLesson_creatingpop_view_loading',\n        src: loading_lesson,\n        alt: 'loading'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 47\n      }, this), this.state.LessonCreated && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          className: \"CreateLesson_creatingpop_done_logo\",\n          viewBox: \"0 0 16 16\",\n          children: [/*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M2.5 8a5.5 5.5 0 0 1 8.25-4.764.5.5 0 0 0 .5-.866A6.5 6.5 0 1 0 14.5 8a.5.5 0 0 0-1 0 5.5 5.5 0 1 1-11 0z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M15.354 3.354a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l7-7z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Lekcja zosta\\u0142a utworzona pomy\\u015Blnie!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"fieldset\", {\n          onClick: this.CopyURL.bind(this),\n          children: [/*#__PURE__*/_jsxDEV(\"legend\", {\n            children: \"Adres URL lekcji\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"https://platforma.edukacyjna.pl/lesson?id=2202\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            width: \"16\",\n            height: \"16\",\n            className: \"bi bi-clipboard-check\",\n            viewBox: \"0 0 16 16\",\n            children: [/*#__PURE__*/_jsxDEV(\"path\", {\n              \"fill-rule\": \"evenodd\",\n              d: \"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Stw\\xF3rz now\\u0105 lekcje\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this);\n  }\n\n  onSelectedFIle(e) {\n    if (e.target.files.length > 0) {\n      this.state.BackgroundName = e.target.files[0].name;\n      this.setState({\n        EditFile: true\n      });\n      const reader = new FileReader();\n      reader.readAsDataURL(e.target.files[0]);\n\n      reader.onload = d => {\n        const img = new Image();\n        img.src = d.target.result;\n\n        img.onload = c => {\n          var _this$cropref;\n\n          (_this$cropref = this.cropref) === null || _this$cropref === void 0 ? void 0 : _this$cropref.current.cropper.replace(c.target.src);\n        };\n      };\n    } else {\n      this.setState({\n        EditFile: false\n      });\n    }\n  }\n\n  ClickOnDate(time) {\n    // console.log(time)\n    time.setMonth(time.getMonth() + 1);\n    document.querySelector('#CreateLesson_main_view_expire_date_input').value = time.getFullYear() + '-' + (time.getMonth().toString().length === 1 ? '0' + time.getMonth() : time.getMonth()) + '-' + (time.getDate().toString().length === 1 ? '0' + time.getDate() : time.getDate());\n  }\n\n  RemoveChapter(id) {\n    if (this.state.Content.Lesson[id] !== undefined) {\n      this.state.Content.Lesson.splice(id, 1);\n      this.forceUpdate();\n    }\n  }\n\n  onCrop() {\n    function blobToFile(theBlob, fileName) {\n      return new File([theBlob], fileName, {\n        lastModified: new Date().getTime(),\n        type: theBlob.type\n      });\n    }\n\n    this.cropref.current.cropper.getCroppedCanvas().toBlob(e => {\n      this.state.Content.Image = blobToFile(e, this.state.BackgroundName);\n    });\n  }\n\n  removeSelectedFile(chapter, ID) {\n    if (this.state.Content.Lesson[chapter] !== undefined && this.state.Content.Lesson[chapter].Files[ID] !== undefined) {\n      this.state.Content.Lesson[chapter].Files.splice(ID, 1);\n      this.forceUpdate();\n    }\n  }\n\n  renderFiles(id) {\n    const tas = [];\n\n    for (let d = 0; d < this.state.Content.Lesson[id].Files.length; d++) {\n      tas.push( /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: this.removeSelectedFile.bind(this, id, d),\n        className: 'Dash_main_view_body_chapter_files_item Dash_main_view_body_chapter_files_item_close_bt ',\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          className: \"bi bi-file-arrow-down\",\n          viewBox: \"0 0 16 16\",\n          children: [/*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M8 5a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 9.293V5.5A.5.5 0 0 1 8 5z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'Dash_main_view_body_chapter_files_item_text',\n          children: [/*#__PURE__*/_jsxDEV(\"a\", {\n            style: {\n              maxWidth: '50%'\n            },\n            children: this.state.Content.Lesson[id].Files[d].name.substr(0, this.state.Content.Lesson[id].Files[d].name.lastIndexOf('.') + 1)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n            children: [\".\", this.state.Content.Lesson[id].Files[d].name.substr(this.state.Content.Lesson[id].Files[d].name.lastIndexOf('.') + 1, this.state.Content.Lesson[id].Files[d].name.length)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: 'Dash_main_view_body_chapter_files_item_close',\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 22\n      }, this));\n    }\n\n    return tas;\n  }\n\n  RenderChapters() {\n    const tab = [];\n\n    for (let i = 0; i < this.state.Content.Lesson.length; i++) {\n      tab.push( /*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'CreateLesson_main_view_body_text',\n        children: [this.state.Content.Lesson.length > 1 && /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Rodzia\\u0142. \", i + 1]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 61\n        }, this), /*#__PURE__*/_jsxDEV(ReactQuill, {\n          modules: this.modules,\n          className: 'CreateLesson_main_view_editor',\n          placeholder: 'Zawartość lekcji',\n          onChange: html => {\n            this.state.Content.Lesson[i].Text = html;\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 17\n        }, this), this.state.Content.Lesson.length > 1 && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: 'CreateLesson_main_view_body_remove_chapter',\n          onClick: this.RemoveChapter.bind(this, i),\n          children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            width: \"16\",\n            height: \"16\",\n            className: \"bi bi-x\",\n            viewBox: \"0 0 16 16\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 21\n          }, this), \"Usu\\u0144 rozdzia\\u0142\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 60\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'CreateLesson_main_view_body_text_answer',\n          children: [/*#__PURE__*/_jsxDEV(\"a\", {\n            style: {\n              display: 'inline-block',\n              marginTop: '15px'\n            },\n            children: \"Odpowiedz w formie:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            onChange: e => {\n              this.state.Content.Lesson[i].Answer = e.target.value;\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: 1,\n              children: \"tekstu\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 2,\n              children: \"pliku/\\xF3w\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 3,\n              children: \"pliku/\\xF3w i tekstu\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Za\\u0142acz pliki\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: 'file',\n              multiple: true,\n              style: {\n                display: 'none'\n              },\n              onChange: e => {\n                this.state.Content.Lesson[i].Files = [...this.state.Content.Lesson[i].Files, ...e.target.files];\n                this.forceUpdate();\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: 'CreateLesson_main_view_body_text_answer_files',\n            children: this.renderFiles(i)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 22\n      }, this));\n    }\n\n    return tab;\n  }\n\n  addChapter() {\n    // console.log(this.state.Content.Lesson[0].Text)\n    if (this.state.Content.Lesson.length < 11) {\n      this.state.Content.Lesson.push({\n        Text: '',\n        Answer: 1,\n        Files: []\n      });\n      this.forceUpdate();\n    }\n  }\n\n  async sendFiles() {\n    let index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    console.log(\"Zaczynam przesyłanie plików...\");\n    const form = new FormData();\n\n    for (let i = 0; i < this.state.Content.Lesson[index].Files.length; i++) {\n      form.append(this.state.Content.Lesson[index].Files[i].name, this.state.Content.Lesson[index].Files[i]);\n    }\n\n    const resp = await fetch(serverPath() + \"api/Files/files.php\", {\n      method: \"POST\",\n      headers: {\n        'Access-Control-Allow-Origin': '*' // 'Content-Type': 'multipart/form-data'\n\n      },\n      body: form,\n      credentials: 'include'\n    }).then(data => data.json()).catch(null);\n\n    if (resp == null) {\n      console.log('Błąd w przesyłaniu plików');\n    } else {\n      if (resp['CODE'] === 'OK') {\n        this.state.Content.Lesson[index].Files = resp['Files'].join('|');\n        console.log('Udało sie przesyłać pliki');\n      } else {\n        console.log('Błąd w przesyłaniu plików');\n      }\n    }\n  }\n\n  async ImageFromEditor(index) {\n    const dataURItoBlob = dataURI => {\n      // convert base64 to raw binary data held in a string\n      // doesn't handle URLEncoded DataURIs - see SO answer #6850276 for code that does this\n      var byteString = atob(dataURI.split(',')[1]); // separate out the mime component\n\n      var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]; // write the bytes of the string to an ArrayBuffer\n\n      var ab = new ArrayBuffer(byteString.length);\n      var ia = new Uint8Array(ab);\n\n      for (var i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n      }\n\n      return new Blob([ab], {\n        type: mimeString\n      });\n    };\n\n    const blobToFile = (theBlob, fileName) => {\n      return new File([theBlob], fileName, {\n        lastModified: new Date().getTime(),\n        type: theBlob.type\n      });\n    };\n\n    const sendData = async Data => {\n      return await fetch(serverPath() + \"/api/Files/ImageContent.php\", {\n        method: \"POST\",\n        headers: {\n          'Access-Control-Allow-Origin': '*' // 'Content-Type': 'multipart/form-data'\n\n        },\n        body: Data,\n        credentials: 'include'\n      }).then(data => data.json()).catch(null);\n    };\n\n    if (this.state.Content.Lesson[index].Text.replaceAll(\" \", \"\") !== \"\") {\n      const htmlParser = document.createElement('body');\n      htmlParser.innerHTML = this.state.Content.Lesson[index].Text;\n      const form = new FormData();\n      let iterator = 1;\n      htmlParser.querySelectorAll('img').forEach(e => {\n        e.id = iterator.toString() + '_image_' + new Date().getTime();\n        const file = dataURItoBlob(e.src);\n        form.append(e.id + '.' + mime.extension(file.type), blobToFile(file, e.id + '.' + mime.extension(file.type)));\n        e.id = e.id + '.' + mime.extension(file.type);\n        iterator += 1;\n      });\n      await sendData(form).then(resp => {\n        if (resp !== null) {\n          if (resp['CODE'] === 'OK') {\n            if (Object.keys(resp['Files']).length > 0) {\n              htmlParser.querySelectorAll('img').forEach(e => {\n                e.src = serverPath() + 'api/Files' + resp['Files'][e.id];\n              });\n              this.state.Content.Lesson[index].Text = htmlParser.innerHTML;\n            }\n          } else {\n            console.log(\"Cos nie poszło z tym edytorem!\");\n          }\n        }\n      });\n    }\n  }\n\n  async sendForm() {\n    // if is ok when post data\n    // console.log(this.state.Content.Lesson[0].Text)\n    if (this.state.Content.Image !== '') {\n      const form = new FormData();\n      form.append(this.state.Content.Image.name, this.state.Content.Image);\n      const resp = await fetch(\"http://192.168.0.7:8080/api/Files/ImageContent.php\", {\n        method: \"POST\",\n        headers: {\n          'Access-Control-Allow-Origin': '*' // 'Content-Type': 'multipart/form-data'\n\n        },\n        body: form,\n        credentials: 'include'\n      }).then(data => data.json()).catch(null);\n\n      if (resp == null) {\n        console.log('Błąd w przesyłaniu plików');\n      } else {\n        if (resp['CODE'] === 'OK') {\n          this.state.Content.Image = resp['Files'][this.state.Content.Image.name];\n          console.log('Udało sie przesyłać pliki');\n        } else {\n          console.log('Błąd w przesyłaniu plików');\n        }\n      }\n    }\n\n    for (let i = 0; i < this.state.Content.Lesson.length; i++) {\n      if (this.state.Content.Lesson[i].Files.length > 0) await this.sendFiles(i);\n      if (this.state.Content.Lesson[i].Text.length > 0) await this.ImageFromEditor(i);\n    }\n\n    try {\n      const resp = await fetch(serverPath() + \"api/Lessons/CreateLesson.php\", {\n        method: \"POST\",\n        headers: {\n          'Access-Control-Allow-Origin': '*',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(this.state.Content),\n        credentials: 'include'\n      }).then(data => data.json()).catch(null);\n\n      if (resp !== null) {\n        if (resp[\"CODE\"] === 'OK') {\n          // window.sessionStorage.setItem('Token', resp['Token'])\n          alert('Lesson created!');\n          return true;\n        } else {\n          return false;\n        }\n      } else return false;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  render() {\n    if (this.state.LoadingPop) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'CreateLesson_main_view',\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'CreateLesson_main_view_header',\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Tworzenie lekcje\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 17\n      }, this), this.CreatingLessonPop()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 13\n    }, this);else return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'CreateLesson_main_view',\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'CreateLesson_main_view_header',\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Tworzenie lekcje\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'CreateLesson_main_view_body',\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            borderBottom: '1px solid #282c34'\n          },\n          onClick: () => {\n            document.querySelector('#subject_input').focus();\n          },\n          className: 'CreateLesson_main_view_body_text',\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Temat\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: 'subject_input',\n            type: 'text',\n            onChange: e => {\n              this.state.Content.Subject = e.target.value;\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'CreateLesson_main_view_body_seletct_background',\n          children: [/*#__PURE__*/_jsxDEV(\"a\", {\n            style: {\n              display: 'inline-block',\n              margin: '10px 0 0 0'\n            },\n            children: \"Ustaw zdjecie lekcji\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 416,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: 'CreateLesson_main_view_select_image',\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: 'file',\n              style: {\n                display: 'none'\n              },\n              accept: 'image/png, image/gif, image/jpeg',\n              onChange: e => {\n                this.onSelectedFIle(e);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 29\n            }, this), \"Wybierz\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 25\n          }, this), this.state.EditFile && /*#__PURE__*/_jsxDEV(Cropper, {\n            src: 'https://wallpaperaccess.com/full/1916098.jpg',\n            className: 'CreateLesson_main_view_body_seletct_background_edit',\n            aspectRatio: 16 / 9,\n            guides: false,\n            checkCrossOrigin: false,\n            responsive: true,\n            scaleX: 1,\n            viewMode: 3,\n            autoCropArea: 1,\n            minCropBoxHeight: 100,\n            minCropBoxWidth: 250,\n            crop: this.onCrop.bind(this),\n            ref: this.cropref\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'CreateLesson_main_view_body_text',\n          children: [/*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"Opis lekcji (Opcjonalne)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            placeholder: 'Opis',\n            onChange: e => {\n              this.state.Content.Desc = e.target.value;\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 443,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Zawarto\\u015B\\u0107 lekcji\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 21\n        }, this), this.RenderChapters(), this.state.Content.Lesson.length < 10 && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: 'CreateLesson_main_view_add_chapter',\n          onClick: this.addChapter.bind(this),\n          children: \"Dodaj rozdzia\\u0142\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 64\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Dost\\u0119pno\\u015B\\u0107 lekcji\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'CreateLesson_main_view_body_text',\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"container_lesson\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              onChange: e => {\n                this.state.Content.EnableCode = e.target.value ? 1 : 0;\n                this.forceUpdate();\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"checkmark_lesson\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 455,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"Zabezpiecz dost\\u0119p do lekcje kodem\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 25\n          }, this), this.state.Content.EnableCode === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: 'CreateLesson_main_view_PassCode',\n            children: [/*#__PURE__*/_jsxDEV(\"a\", {\n              style: {\n                display: 'block',\n                margin: '0 10px 10px 10px',\n                paddingLeft: '20px'\n              },\n              children: \"Aby wykonywa\\u0107 dan\\u0105 lekcja trzeba najpierw poda\\u0107 ten kod.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: 'text',\n              placeholder: 'Kod',\n              onChange: e => {\n                this.state.Content.Code = e.target.value;\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              children: \"Generuj losowy kod\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 464,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'CreateLesson_main_view_body_text',\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"container_lesson\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              onChange: e => {\n                this.state.Content.CanExpire = e.target.value ? 1 : 0;\n                this.forceUpdate();\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 472,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"checkmark_lesson\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 471,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"Ogranicz czasowo widoczno\\u015Bc lekcji\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 25\n          }, this), this.state.Content.CanExpire === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: 'fit-content'\n            },\n            className: 'CreateLesson_main_view_expire_date',\n            children: [/*#__PURE__*/_jsxDEV(\"a\", {\n              children: \"Data po kt\\xF3rej lekcja nie b\\u0119dzie ju\\u017C widoczna\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              id: 'CreateLesson_main_view_expire_date_input',\n              onClick: () => {\n                {\n                  this.setState({\n                    CalendarOpen: true\n                  });\n                }\n              },\n              type: 'button',\n              value: '2022-04-1'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 33\n            }, this), this.state.CalendarOpen && /*#__PURE__*/_jsxDEV(Calendar_pop, {\n              onSelect: e => {\n                this.ClickOnDate(e);\n              },\n              close: () => {\n                this.setState({\n                  CalendarOpen: false\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 61\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 478,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'CreateLesson_main_view_body_text',\n          children: [/*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"Przypisz u\\u017Cytkownik\\xF3w bad\\u017A grupy do lekcji.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 499,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(ShareLesson, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 500,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'CreateLesson_main_view_summary',\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.sendForm.bind(this),\n          children: \"Stw\\xF3rz\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 504,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/michalratajewski/edupage/files/learning/src/windows/CreateLesson.js"],"names":["React","memo","useMemo","Cropper","ReactQuill","Calendar_pop","ShareLesson","mime","serverPath","loading_lesson","CreateLesson","Component","constructor","props","state","UrlPath","LoadingPop","LessonCreated","EditFile","CalendarOpen","BackgroundName","AdditionalImages","Content","Subject","Image","Desc","Lesson","Text","Answer","Files","EnableCode","Code","CanExpire","Expire","Date","toLocaleDateString","Users","Groups","cropref","createRef","modules","toolbar","container","CopyURL","navigator","clipboard","writeText","CreatingLessonPop","bind","onSelectedFIle","e","target","files","length","name","setState","reader","FileReader","readAsDataURL","onload","d","img","src","result","c","current","cropper","replace","ClickOnDate","time","setMonth","getMonth","document","querySelector","value","getFullYear","toString","getDate","RemoveChapter","id","undefined","splice","forceUpdate","onCrop","blobToFile","theBlob","fileName","File","lastModified","getTime","type","getCroppedCanvas","toBlob","removeSelectedFile","chapter","ID","renderFiles","tas","push","maxWidth","substr","lastIndexOf","RenderChapters","tab","i","html","display","marginTop","addChapter","sendFiles","index","console","log","form","FormData","append","resp","fetch","method","headers","body","credentials","then","data","json","catch","join","ImageFromEditor","dataURItoBlob","dataURI","byteString","atob","split","mimeString","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","Blob","sendData","Data","replaceAll","htmlParser","createElement","innerHTML","iterator","querySelectorAll","forEach","file","extension","Object","keys","sendForm","JSON","stringify","alert","render","borderBottom","focus","margin","paddingLeft","width"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,IAAf,EAAqBC,OAArB,QAAmC,OAAnC;AACA,OAAO,4BAAP;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAO,4BAAP;AACA,OAAOC,UAAP,MAAuB,aAAvB;AACA,OAAO,iCAAP;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAO,KAAKC,IAAZ,MAAsB,yBAAtB;AAEA,OAAOC,UAAP,MAAuB,uBAAvB;AAEA,OAAOC,cAAP,MAA2B,8BAA3B;;AAEA,eAAe,MAAMC,YAAN,SAA2BV,KAAK,CAACW,SAAjC,CAA2C;AAEtDC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AAEA,SAAKC,KAAL,GAAa;AACTC,MAAAA,OAAO,EAAE,YADA;AAETC,MAAAA,UAAU,EAAE,IAFH;AAGTC,MAAAA,aAAa,EAAE,IAHN;AAITC,MAAAA,QAAQ,EAAE,KAJD;AAKTC,MAAAA,YAAY,EAAE,KALL;AAMTC,MAAAA,cAAc,EAAE,EANP;AAOTC,MAAAA,gBAAgB,EAAE,EAPT;AAQTC,MAAAA,OAAO,EAAE;AACLC,QAAAA,OAAO,EAAE,EADJ;AAELC,QAAAA,KAAK,EAAE,EAFF;AAGLC,QAAAA,IAAI,EAAE,EAHD;AAILC,QAAAA,MAAM,EAAE,CACJ;AACIC,UAAAA,IAAI,EAAE,EADV;AAEIC,UAAAA,MAAM,EAAE,CAFZ;AAGIC,UAAAA,KAAK,EAAE;AAHX,SADI,CAJH;AAWLC,QAAAA,UAAU,EAAE,CAXP;AAYLC,QAAAA,IAAI,EAAE,EAZD;AAaLC,QAAAA,SAAS,EAAE,CAbN;AAcLC,QAAAA,MAAM,EAAE,IAAIC,IAAJ,GAAWC,kBAAX,EAdH;AAeLC,QAAAA,KAAK,EAAE,EAfF;AAgBLC,QAAAA,MAAM,EAAE;AAhBH;AARA,KAAb;AA4BA,SAAKC,OAAL,gBAAetC,KAAK,CAACuC,SAAN,EAAf;AAEA,SAAKC,OAAL,GAAe;AACXC,MAAAA,OAAO,EAAE;AACLC,QAAAA,SAAS,EAAE,CACP,CAAC;AAAE,oBAAU,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,KAAnB;AAAZ,SAAD,CADO,EAEP,CAAC,MAAD,EAAS,QAAT,EAAmB,WAAnB,CAFO,EAGP,CAAC;AAAE,kBAAQ;AAAV,SAAD,EAAwB;AAAE,kBAAQ;AAAV,SAAxB,CAHO,EAIP,CAAC;AAAE,mBAAS;AAAX,SAAD,CAJO,EAKP,CAAC,MAAD,EAAS,OAAT,CALO,EAMP,CAAC,OAAD,CANO,EAOP,CAAC;AAAE,mBAAS;AAAX,SAAD,CAPO,CADN,CAYL;AACA;AACA;;AAdK;AADE,KAAf;AAkBH;;AAGDC,EAAAA,OAAO,GAAG;AACNC,IAAAA,SAAS,CAACC,SAAV,CAAoBC,SAApB;AACH;;AAEDC,EAAAA,iBAAiB,GAAG;AAChB,wBACI;AAAK,MAAA,SAAS,EAAE,0BAAhB;AAAA,iBACK,CAAC,KAAKjC,KAAL,CAAWG,aAAZ,iBAA6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADlC,EAEK,CAAC,KAAKH,KAAL,CAAWG,aAAZ,iBAA6B;AAAK,QAAA,SAAS,EAAE,uCAAhB;AAAyD,QAAA,GAAG,EAAER,cAA9D;AAA8E,QAAA,GAAG,EAAE;AAAnF;AAAA;AAAA;AAAA;AAAA,cAFlC,EAKQ,KAAKK,KAAL,CAAWG,aAAX,iBAEA;AAAA,gCACI;AAAK,UAAA,KAAK,EAAC,4BAAX;AAAwC,UAAA,KAAK,EAAC,IAA9C;AAAmD,UAAA,MAAM,EAAC,IAA1D;AACK,UAAA,SAAS,EAAC,oCADf;AACoD,UAAA,OAAO,EAAC,WAD5D;AAAA,kCAEI;AACI,YAAA,CAAC,EAAC;AADN;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAII;AACI,YAAA,CAAC,EAAC;AADN;AAAA;AAAA;AAAA;AAAA,kBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAQI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBARJ,eASI;AAAU,UAAA,OAAO,EAAE,KAAK0B,OAAL,CAAaK,IAAb,CAAkB,IAAlB,CAAnB;AAAA,kCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAGI;AAAK,YAAA,KAAK,EAAC,4BAAX;AAAwC,YAAA,KAAK,EAAC,IAA9C;AAAmD,YAAA,MAAM,EAAC,IAA1D;AACK,YAAA,SAAS,EAAC,uBADf;AACuC,YAAA,OAAO,EAAC,WAD/C;AAAA,oCAEI;AAAM,2BAAU,SAAhB;AACM,cAAA,CAAC,EAAC;AADR;AAAA;AAAA;AAAA;AAAA,oBAFJ,eAII;AACI,cAAA,CAAC,EAAC;AADN;AAAA;AAAA;AAAA;AAAA,oBAJJ,eAMI;AACI,cAAA,CAAC,EAAC;AADN;AAAA;AAAA;AAAA;AAAA,oBANJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBATJ,eAsBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAtBJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAPR;AAAA;AAAA;AAAA;AAAA;AAAA,YADJ;AAoCH;;AAEDC,EAAAA,cAAc,CAACC,CAAD,EAAI;AACd,QAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAeC,MAAf,GAAwB,CAA5B,EAA+B;AAC3B,WAAKvC,KAAL,CAAWM,cAAX,GAA4B8B,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,EAAkBE,IAA9C;AACA,WAAKC,QAAL,CAAc;AAACrC,QAAAA,QAAQ,EAAE;AAAX,OAAd;AACA,YAAMsC,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACAD,MAAAA,MAAM,CAACE,aAAP,CAAqBR,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAArB;;AACAI,MAAAA,MAAM,CAACG,MAAP,GAAiBC,CAAD,IAAO;AACnB,cAAMC,GAAG,GAAG,IAAIrC,KAAJ,EAAZ;AACAqC,QAAAA,GAAG,CAACC,GAAJ,GAAUF,CAAC,CAACT,MAAF,CAASY,MAAnB;;AACAF,QAAAA,GAAG,CAACF,MAAJ,GAAcK,CAAD,IAAO;AAAA;;AAChB,gCAAK1B,OAAL,gEAAc2B,OAAd,CAAsBC,OAAtB,CAA8BC,OAA9B,CAAsCH,CAAC,CAACb,MAAF,CAASW,GAA/C;AACH,SAFD;AAGH,OAND;AAOH,KAZD,MAYO;AACH,WAAKP,QAAL,CAAc;AAACrC,QAAAA,QAAQ,EAAE;AAAX,OAAd;AACH;AACJ;;AAEDkD,EAAAA,WAAW,CAACC,IAAD,EAAO;AACd;AACAA,IAAAA,IAAI,CAACC,QAAL,CAAcD,IAAI,CAACE,QAAL,KAAkB,CAAhC;AACAC,IAAAA,QAAQ,CAACC,aAAT,CAAuB,2CAAvB,EACKC,KADL,GACaL,IAAI,CAACM,WAAL,KAAqB,GAArB,IAA4BN,IAAI,CAACE,QAAL,GAAgBK,QAAhB,GAA2BvB,MAA3B,KAAsC,CAAtC,GAA0C,MAAMgB,IAAI,CAACE,QAAL,EAAhD,GAAkEF,IAAI,CAACE,QAAL,EAA9F,IAAiH,GAAjH,IAAwHF,IAAI,CAACQ,OAAL,GAAeD,QAAf,GAA0BvB,MAA1B,KAAqC,CAArC,GAAyC,MAAMgB,IAAI,CAACQ,OAAL,EAA/C,GAAgER,IAAI,CAACQ,OAAL,EAAxL,CADb;AAEH;;AAEDC,EAAAA,aAAa,CAACC,EAAD,EAAK;AACd,QAAI,KAAKjE,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BqD,EAA1B,MAAkCC,SAAtC,EAAiD;AAC7C,WAAKlE,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BuD,MAA1B,CAAiCF,EAAjC,EAAsC,CAAtC;AACA,WAAKG,WAAL;AACH;AACJ;;AAEDC,EAAAA,MAAM,GAAG;AACL,aAASC,UAAT,CAAoBC,OAApB,EAA6BC,QAA7B,EAAsC;AAClC,aAAO,IAAIC,IAAJ,CAAS,CAACF,OAAD,CAAT,EAAoBC,QAApB,EAA8B;AAAEE,QAAAA,YAAY,EAAE,IAAItD,IAAJ,GAAWuD,OAAX,EAAhB;AAAsCC,QAAAA,IAAI,EAAEL,OAAO,CAACK;AAApD,OAA9B,CAAP;AACH;;AACD,SAAKpD,OAAL,CAAa2B,OAAb,CAAqBC,OAArB,CAA6ByB,gBAA7B,GAAgDC,MAAhD,CAAwD1C,CAAD,IAAO;AAAC,WAAKpC,KAAL,CAAWQ,OAAX,CAAmBE,KAAnB,GAA2B4D,UAAU,CAAClC,CAAD,EAAI,KAAKpC,KAAL,CAAWM,cAAf,CAArC;AAAqE,KAApI;AACH;;AAEDyE,EAAAA,kBAAkB,CAACC,OAAD,EAAUC,EAAV,EAAc;AAC5B,QAAI,KAAKjF,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoE,OAA1B,MAAuCd,SAAvC,IAAqD,KAAKlE,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoE,OAA1B,EAAmCjE,KAAnC,CAAyCkE,EAAzC,MAAiDf,SAA1G,EAAqH;AACjH,WAAKlE,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoE,OAA1B,EAAmCjE,KAAnC,CAAyCoD,MAAzC,CAAgDc,EAAhD,EAAoD,CAApD;AACA,WAAKb,WAAL;AACH;AACJ;;AAEDc,EAAAA,WAAW,CAACjB,EAAD,EAAK;AACZ,UAAMkB,GAAG,GAAG,EAAZ;;AACA,SAAI,IAAIrC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,KAAK9C,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BqD,EAA1B,EAA8BlD,KAA9B,CAAoCwB,MAAvD,EAA+DO,CAAC,EAAhE,EAAoE;AAChEqC,MAAAA,GAAG,CAACC,IAAJ,eAAS;AAAK,QAAA,OAAO,EAAE,KAAKL,kBAAL,CAAwB7C,IAAxB,CAA6B,IAA7B,EAAmC+B,EAAnC,EAAuCnB,CAAvC,CAAd;AAAyD,QAAA,SAAS,EAAE,yFAApE;AAAA,gCACL;AAAK,UAAA,KAAK,EAAC,4BAAX;AAAwC,UAAA,KAAK,EAAC,IAA9C;AAAmD,UAAA,MAAM,EAAC,IAA1D;AACK,UAAA,SAAS,EAAC,uBADf;AACuC,UAAA,OAAO,EAAC,WAD/C;AAAA,kCAEI;AACI,YAAA,CAAC,EAAC;AADN;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAII;AACI,YAAA,CAAC,EAAC;AADN;AAAA;AAAA;AAAA;AAAA,kBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBADK,eAQL;AAAK,UAAA,SAAS,EAAE,6CAAhB;AAAA,kCACI;AAAG,YAAA,KAAK,EAAE;AAACuC,cAAAA,QAAQ,EAAE;AAAX,aAAV;AAAA,sBAEQ,KAAKrF,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BqD,EAA1B,EAA8BlD,KAA9B,CAAoC+B,CAApC,EAAuCN,IAAvC,CAA4C8C,MAA5C,CAAmD,CAAnD,EAAsD,KAAKtF,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BqD,EAA1B,EAA8BlD,KAA9B,CAAoC+B,CAApC,EAAuCN,IAAvC,CAA4C+C,WAA5C,CAAwD,GAAxD,IAA+D,CAArH;AAFR;AAAA;AAAA;AAAA;AAAA,kBADJ,eAMI;AAAA,4BAGQ,KAAKvF,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BqD,EAA1B,EAA8BlD,KAA9B,CAAoC+B,CAApC,EAAuCN,IAAvC,CAA4C8C,MAA5C,CAAmD,KAAKtF,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BqD,EAA1B,EAA8BlD,KAA9B,CAAoC+B,CAApC,EAAuCN,IAAvC,CAA4C+C,WAA5C,CAAwD,GAAxD,IAA+D,CAAlH,EAAqH,KAAKvF,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BqD,EAA1B,EAA8BlD,KAA9B,CAAoC+B,CAApC,EAAuCN,IAAvC,CAA4CD,MAAjK,CAHR;AAAA;AAAA;AAAA;AAAA;AAAA,kBANJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBARK,eAsBL;AAAK,UAAA,SAAS,EAAE,8CAAhB;AAAgE,UAAA,KAAK,EAAC,4BAAtE;AAAmG,UAAA,KAAK,EAAC,IAAzG;AAA8G,UAAA,MAAM,EAAC,IAArH;AACK,UAAA,OAAO,EAAC,WADb;AAAA,iCAEI;AACI,YAAA,CAAC,EAAC;AADN;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,gBAtBK;AAAA;AAAA;AAAA;AAAA;AAAA,cAAT;AA4BC;;AACL,WAAO4C,GAAP;AACH;;AAEDK,EAAAA,cAAc,GAAG;AACb,UAAMC,GAAG,GAAG,EAAZ;;AACA,SAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,KAAK1F,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B2B,MAA7C,EAAqDmD,CAAC,EAAtD,EAA0D;AACtDD,MAAAA,GAAG,CAACL,IAAJ,eAAS;AAAK,QAAA,SAAS,EAAE,kCAAhB;AAAA,mBACF,KAAKpF,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B2B,MAA1B,GAAmC,CAApC,iBAA0C;AAAA,uCAAcmD,CAAC,GAAG,CAAlB;AAAA;AAAA;AAAA;AAAA;AAAA,gBADvC,eAEL,QAAC,UAAD;AAAY,UAAA,OAAO,EAAE,KAAKhE,OAA1B;AAAmC,UAAA,SAAS,EAAE,+BAA9C;AAA+E,UAAA,WAAW,EAAE,kBAA5F;AAAgH,UAAA,QAAQ,EAAGiE,IAAD,IAAU;AAAC,iBAAK3F,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B8E,CAA1B,EAA6B7E,IAA7B,GAAoC8E,IAApC;AAAyC;AAA9K;AAAA;AAAA;AAAA;AAAA,gBAFK,EAIH,KAAK3F,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B2B,MAA1B,GAAmC,CAApC,iBAA0C;AAAQ,UAAA,SAAS,EAAE,4CAAnB;AAAiE,UAAA,OAAO,EAAE,KAAKyB,aAAL,CAAmB9B,IAAnB,CAAwB,IAAxB,EAA8BwD,CAA9B,CAA1E;AAAA,kCACvC;AAAK,YAAA,KAAK,EAAC,4BAAX;AAAwC,YAAA,KAAK,EAAC,IAA9C;AAAmD,YAAA,MAAM,EAAC,IAA1D;AACK,YAAA,SAAS,EAAC,SADf;AACyB,YAAA,OAAO,EAAC,WADjC;AAAA,mCAEI;AACI,cAAA,CAAC,EAAC;AADN;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,kBADuC;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJtC,eAaL;AAAK,UAAA,SAAS,EAAE,yCAAhB;AAAA,kCACI;AAAG,YAAA,KAAK,EAAE;AAACE,cAAAA,OAAO,EAAE,cAAV;AAA0BC,cAAAA,SAAS,EAAE;AAArC,aAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAQ,YAAA,QAAQ,EAAGzD,CAAD,IAAO;AAAC,mBAAKpC,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B8E,CAA1B,EAA6B5E,MAA7B,GAAsCsB,CAAC,CAACC,MAAF,CAASuB,KAA/C;AAAqD,aAA/E;AAAA,oCACI;AAAQ,cAAA,KAAK,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAQ,cAAA,KAAK,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFJ,eAGI;AAAQ,cAAA,KAAK,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAOI;AAAA,yDAEI;AAAO,cAAA,IAAI,EAAE,MAAb;AAAqB,cAAA,QAAQ,MAA7B;AAA8B,cAAA,KAAK,EAAE;AAACgC,gBAAAA,OAAO,EAAE;AAAV,eAArC;AAAwD,cAAA,QAAQ,EAC3DxD,CAAD,IAAO;AACH,qBAAKpC,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B8E,CAA1B,EAA6B3E,KAA7B,GAAqC,CAAC,GAAG,KAAKf,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B8E,CAA1B,EAA6B3E,KAAjC,EAAwC,GAAGqB,CAAC,CAACC,MAAF,CAASC,KAApD,CAArC;AACA,qBAAK8B,WAAL;AACH;AAJL;AAAA;AAAA;AAAA;AAAA,oBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBAPJ,eAgBI;AAAK,YAAA,SAAS,EAAE,+CAAhB;AAAA,sBAEO,KAAKc,WAAL,CAAiBQ,CAAjB;AAFP;AAAA;AAAA;AAAA;AAAA,kBAhBJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAbK;AAAA;AAAA;AAAA;AAAA;AAAA,cAAT;AAoCH;;AACD,WAAOD,GAAP;AACH;;AAEDK,EAAAA,UAAU,GAAG;AACT;AACA,QAAI,KAAK9F,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B2B,MAA1B,GAAmC,EAAvC,EAA2C;AACvC,WAAKvC,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BwE,IAA1B,CAA+B;AAACvE,QAAAA,IAAI,EAAE,EAAP;AAAWC,QAAAA,MAAM,EAAE,CAAnB;AAAsBC,QAAAA,KAAK,EAAE;AAA7B,OAA/B;AACA,WAAKqD,WAAL;AACH;AACJ;;AAEc,QAAT2B,SAAS,GAAY;AAAA,QAAXC,KAAW,uEAAH,CAAG;AACvBC,IAAAA,OAAO,CAACC,GAAR,CAAY,gCAAZ;AACA,UAAMC,IAAI,GAAG,IAAIC,QAAJ,EAAb;;AACA,SAAK,IAAIV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK1F,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoF,KAA1B,EAAiCjF,KAAjC,CAAuCwB,MAA3D,EAAmEmD,CAAC,EAApE,EAAwE;AACpES,MAAAA,IAAI,CAACE,MAAL,CAAY,KAAKrG,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoF,KAA1B,EAAiCjF,KAAjC,CAAuC2E,CAAvC,EAA0ClD,IAAtD,EAA4D,KAAKxC,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoF,KAA1B,EAAiCjF,KAAjC,CAAuC2E,CAAvC,CAA5D;AACH;;AACD,UAAMY,IAAI,GAAG,MAAMC,KAAK,CAAC7G,UAAU,KAAK,qBAAhB,EAAuC;AAC3D8G,MAAAA,MAAM,EAAC,MADoD;AAE3DC,MAAAA,OAAO,EAAE;AACL,uCAA8B,GADzB,CAEL;;AAFK,OAFkD;AAM3DC,MAAAA,IAAI,EAAEP,IANqD;AAO3DQ,MAAAA,WAAW,EAAE;AAP8C,KAAvC,CAAL,CAQhBC,IARgB,CAQXC,IAAI,IAAIA,IAAI,CAACC,IAAL,EARG,EAQUC,KARV,CAQgB,IARhB,CAAnB;;AAUA,QAAIT,IAAI,IAAI,IAAZ,EAAkB;AACdL,MAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH,KAFD,MAEO;AACH,UAAII,IAAI,CAAC,MAAD,CAAJ,KAAiB,IAArB,EAA2B;AACvB,aAAKtG,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoF,KAA1B,EAAiCjF,KAAjC,GAAyCuF,IAAI,CAAC,OAAD,CAAJ,CAAcU,IAAd,CAAmB,GAAnB,CAAzC;AACAf,QAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH,OAHD,MAGO;AACHD,QAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH;AACJ;AACJ;;AAEoB,QAAfe,eAAe,CAACjB,KAAD,EAAQ;AACzB,UAAMkB,aAAa,GAAIC,OAAD,IAAa;AAC/B;AACA;AACA,UAAIC,UAAU,GAAGC,IAAI,CAACF,OAAO,CAACG,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAD,CAArB,CAH+B,CAK/B;;AACA,UAAIC,UAAU,GAAGJ,OAAO,CAACG,KAAR,CAAc,GAAd,EAAmB,CAAnB,EAAsBA,KAAtB,CAA4B,GAA5B,EAAiC,CAAjC,EAAoCA,KAApC,CAA0C,GAA1C,EAA+C,CAA/C,CAAjB,CAN+B,CAQ/B;;AACA,UAAIE,EAAE,GAAG,IAAIC,WAAJ,CAAgBL,UAAU,CAAC7E,MAA3B,CAAT;AACA,UAAImF,EAAE,GAAG,IAAIC,UAAJ,CAAeH,EAAf,CAAT;;AACA,WAAK,IAAI9B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0B,UAAU,CAAC7E,MAA/B,EAAuCmD,CAAC,EAAxC,EAA4C;AACxCgC,QAAAA,EAAE,CAAChC,CAAD,CAAF,GAAQ0B,UAAU,CAACQ,UAAX,CAAsBlC,CAAtB,CAAR;AACH;;AAED,aAAO,IAAImC,IAAJ,CAAS,CAACL,EAAD,CAAT,EAAe;AAAC5C,QAAAA,IAAI,EAAE2C;AAAP,OAAf,CAAP;AACH,KAhBD;;AAkBA,UAAMjD,UAAU,GAAG,CAACC,OAAD,EAAUC,QAAV,KAAuB;AACtC,aAAO,IAAIC,IAAJ,CAAS,CAACF,OAAD,CAAT,EAAoBC,QAApB,EAA8B;AAAEE,QAAAA,YAAY,EAAE,IAAItD,IAAJ,GAAWuD,OAAX,EAAhB;AAAsCC,QAAAA,IAAI,EAAEL,OAAO,CAACK;AAApD,OAA9B,CAAP;AACH,KAFD;;AAIA,UAAMkD,QAAQ,GAAG,MAAOC,IAAP,IAAgB;AAC7B,aAAO,MAAMxB,KAAK,CAAC7G,UAAU,KAAK,6BAAhB,EAA+C;AAC7D8G,QAAAA,MAAM,EAAC,MADsD;AAE7DC,QAAAA,OAAO,EAAE;AACL,yCAA8B,GADzB,CAEL;;AAFK,SAFoD;AAM7DC,QAAAA,IAAI,EAAEqB,IANuD;AAO7DpB,QAAAA,WAAW,EAAE;AAPgD,OAA/C,CAAL,CAQVC,IARU,CAQLC,IAAI,IAAIA,IAAI,CAACC,IAAL,EARH,EAQgBC,KARhB,CAQsB,IARtB,CAAb;AASH,KAVD;;AAYA,QAAI,KAAK/G,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoF,KAA1B,EAAiCnF,IAAjC,CAAsCmH,UAAtC,CAAiD,GAAjD,EAAsD,EAAtD,MAA8D,EAAlE,EAAsE;AAClE,YAAMC,UAAU,GAAGvE,QAAQ,CAACwE,aAAT,CAAuB,MAAvB,CAAnB;AACAD,MAAAA,UAAU,CAACE,SAAX,GAAuB,KAAKnI,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoF,KAA1B,EAAiCnF,IAAxD;AACA,YAAMsF,IAAI,GAAG,IAAIC,QAAJ,EAAb;AACA,UAAIgC,QAAQ,GAAG,CAAf;AACAH,MAAAA,UAAU,CAACI,gBAAX,CAA4B,KAA5B,EAAmCC,OAAnC,CAA4ClG,CAAD,IAAO;AAC9CA,QAAAA,CAAC,CAAC6B,EAAF,GAAOmE,QAAQ,CAACtE,QAAT,KAAsB,SAAtB,GAAkC,IAAI1C,IAAJ,GAAWuD,OAAX,EAAzC;AACA,cAAM4D,IAAI,GAAGrB,aAAa,CAAC9E,CAAC,CAACY,GAAH,CAA1B;AACAmD,QAAAA,IAAI,CAACE,MAAL,CAAYjE,CAAC,CAAC6B,EAAF,GAAO,GAAP,GAAaxE,IAAI,CAAC+I,SAAL,CAAeD,IAAI,CAAC3D,IAApB,CAAzB,EAAoDN,UAAU,CAACiE,IAAD,EAAOnG,CAAC,CAAC6B,EAAF,GAAO,GAAP,GAAaxE,IAAI,CAAC+I,SAAL,CAAeD,IAAI,CAAC3D,IAApB,CAApB,CAA9D;AACAxC,QAAAA,CAAC,CAAC6B,EAAF,GAAO7B,CAAC,CAAC6B,EAAF,GAAO,GAAP,GAAaxE,IAAI,CAAC+I,SAAL,CAAeD,IAAI,CAAC3D,IAApB,CAApB;AACAwD,QAAAA,QAAQ,IAAI,CAAZ;AACH,OAND;AAOA,YAAMN,QAAQ,CAAC3B,IAAD,CAAR,CAAeS,IAAf,CAAqBN,IAAD,IAAU;AAChC,YAAIA,IAAI,KAAK,IAAb,EAAmB;AACf,cAAIA,IAAI,CAAC,MAAD,CAAJ,KAAiB,IAArB,EAA2B;AACvB,gBAAImC,MAAM,CAACC,IAAP,CAAYpC,IAAI,CAAC,OAAD,CAAhB,EAA2B/D,MAA3B,GAAoC,CAAxC,EAA2C;AACvC0F,cAAAA,UAAU,CAACI,gBAAX,CAA4B,KAA5B,EACKC,OADL,CACclG,CAAD,IAAO;AACRA,gBAAAA,CAAC,CAACY,GAAF,GAAQtD,UAAU,KAAK,WAAf,GAA6B4G,IAAI,CAAC,OAAD,CAAJ,CAAclE,CAAC,CAAC6B,EAAhB,CAArC;AACH,eAHT;AAKA,mBAAKjE,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0BoF,KAA1B,EAAiCnF,IAAjC,GAAwCoH,UAAU,CAACE,SAAnD;AACH;AACJ,WATD,MASO;AACHlC,YAAAA,OAAO,CAACC,GAAR,CAAY,gCAAZ;AACH;AACJ;AACJ,OAfK,CAAN;AAgBH;AACJ;;AAEa,QAARyC,QAAQ,GAAG;AACb;AACA;AACA,QAAI,KAAK3I,KAAL,CAAWQ,OAAX,CAAmBE,KAAnB,KAA6B,EAAjC,EAAqC;AACjC,YAAMyF,IAAI,GAAG,IAAIC,QAAJ,EAAb;AACAD,MAAAA,IAAI,CAACE,MAAL,CAAY,KAAKrG,KAAL,CAAWQ,OAAX,CAAmBE,KAAnB,CAAyB8B,IAArC,EAA2C,KAAKxC,KAAL,CAAWQ,OAAX,CAAmBE,KAA9D;AACA,YAAM4F,IAAI,GAAG,MAAMC,KAAK,CAAC,oDAAD,EAAuD;AAC3EC,QAAAA,MAAM,EAAC,MADoE;AAE3EC,QAAAA,OAAO,EAAE;AACL,yCAA8B,GADzB,CAEL;;AAFK,SAFkE;AAM3EC,QAAAA,IAAI,EAAEP,IANqE;AAO3EQ,QAAAA,WAAW,EAAE;AAP8D,OAAvD,CAAL,CAQhBC,IARgB,CAQXC,IAAI,IAAIA,IAAI,CAACC,IAAL,EARG,EAQUC,KARV,CAQgB,IARhB,CAAnB;;AASA,UAAIT,IAAI,IAAI,IAAZ,EAAkB;AACdL,QAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH,OAFD,MAEO;AACH,YAAII,IAAI,CAAC,MAAD,CAAJ,KAAiB,IAArB,EAA2B;AACvB,eAAKtG,KAAL,CAAWQ,OAAX,CAAmBE,KAAnB,GAA2B4F,IAAI,CAAC,OAAD,CAAJ,CAAc,KAAKtG,KAAL,CAAWQ,OAAX,CAAmBE,KAAnB,CAAyB8B,IAAvC,CAA3B;AACAyD,UAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH,SAHD,MAGO;AACHD,UAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH;AACJ;AACJ;;AACD,SAAK,IAAIR,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK1F,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B2B,MAA9C,EAAsDmD,CAAC,EAAvD,EAA2D;AACvD,UAAI,KAAK1F,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B8E,CAA1B,EAA6B3E,KAA7B,CAAmCwB,MAAnC,GAA4C,CAAhD,EAAmD,MAAM,KAAKwD,SAAL,CAAeL,CAAf,CAAN;AACnD,UAAI,KAAK1F,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B8E,CAA1B,EAA6B7E,IAA7B,CAAkC0B,MAAlC,GAA2C,CAA/C,EAAkD,MAAM,KAAK0E,eAAL,CAAqBvB,CAArB,CAAN;AACrD;;AACD,QAAI;AACA,YAAMY,IAAI,GAAG,MAAMC,KAAK,CAAC7G,UAAU,KAAK,8BAAhB,EAAgD;AACpE8G,QAAAA,MAAM,EAAE,MAD4D;AAEpEC,QAAAA,OAAO,EAAE;AACL,yCAA8B,GADzB;AAEL,0BAAgB;AAFX,SAF2D;AAMpEC,QAAAA,IAAI,EAAEkC,IAAI,CAACC,SAAL,CAAe,KAAK7I,KAAL,CAAWQ,OAA1B,CAN8D;AAOpEmG,QAAAA,WAAW,EAAE;AAPuD,OAAhD,CAAL,CAQhBC,IARgB,CAQXC,IAAI,IAAIA,IAAI,CAACC,IAAL,EARG,EAQUC,KARV,CAQgB,IARhB,CAAnB;;AAUA,UAAIT,IAAI,KAAK,IAAb,EAAmB;AACf,YAAIA,IAAI,CAAC,MAAD,CAAJ,KAAiB,IAArB,EAA2B;AACvB;AACAwC,UAAAA,KAAK,CAAC,iBAAD,CAAL;AACA,iBAAO,IAAP;AACH,SAJD,MAIO;AACH,iBAAO,KAAP;AACH;AACJ,OARD,MAQO,OAAO,KAAP;AAEV,KArBD,CAqBE,OAAO1G,CAAP,EAAU;AACR,aAAO,KAAP;AACH;AACJ;;AAED2G,EAAAA,MAAM,GAAG;AACL,QAAI,KAAK/I,KAAL,CAAWE,UAAf,EAA2B,oBACvB;AAAK,MAAA,SAAS,EAAE,wBAAhB;AAAA,8BACI;AAAK,QAAA,SAAS,EAAE,+BAAhB;AAAA,+BACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADJ,EAIK,KAAK+B,iBAAL,EAJL;AAAA;AAAA;AAAA;AAAA;AAAA,YADuB,CAA3B,KAQK,oBACD;AAAK,MAAA,SAAS,EAAE,wBAAhB;AAAA,8BACI;AAAK,QAAA,SAAS,EAAE,+BAAhB;AAAA,+BACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADJ,eAII;AAAK,QAAA,SAAS,EAAE,6BAAhB;AAAA,gCACI;AAAK,UAAA,KAAK,EAAE;AAAC+G,YAAAA,YAAY,EAAE;AAAf,WAAZ;AAAiD,UAAA,OAAO,EAAE,MAAM;AAACtF,YAAAA,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,EAAyCsF,KAAzC;AAAiD,WAAlH;AAAoH,UAAA,SAAS,EAAE,kCAA/H;AAAA,kCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAO,YAAA,EAAE,EAAE,eAAX;AAA4B,YAAA,IAAI,EAAE,MAAlC;AAA2C,YAAA,QAAQ,EAAG7G,CAAD,IAAO;AAAE,mBAAKpC,KAAL,CAAWQ,OAAX,CAAmBC,OAAnB,GAA6B2B,CAAC,CAACC,MAAF,CAASuB,KAAtC;AAA6C;AAA3G;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAKI;AAAK,UAAA,SAAS,EAAE,gDAAhB;AAAA,kCACI;AAAG,YAAA,KAAK,EAAE;AAACgC,cAAAA,OAAO,EAAE,cAAV;AAA0BsD,cAAAA,MAAM,EAAE;AAAlC,aAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAO,YAAA,SAAS,EAAE,qCAAlB;AAAA,oCACI;AAAO,cAAA,IAAI,EAAE,MAAb;AAAqB,cAAA,KAAK,EAAE;AAACtD,gBAAAA,OAAO,EAAE;AAAV,eAA5B;AAA+C,cAAA,MAAM,EAAE,kCAAvD;AACO,cAAA,QAAQ,EAAGxD,CAAD,IAAO;AACb,qBAAKD,cAAL,CAAoBC,CAApB;AACH;AAHR;AAAA;AAAA;AAAA;AAAA,oBADJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,EAUK,KAAKpC,KAAL,CAAWI,QAAX,iBACG,QAAC,OAAD;AAAS,YAAA,GAAG,EAAE,8CAAd;AACM,YAAA,SAAS,EAAE,qDADjB;AAEM,YAAA,WAAW,EAAE,KAAK,CAFxB;AAGM,YAAA,MAAM,EAAE,KAHd;AAIM,YAAA,gBAAgB,EAAE,KAJxB;AAKM,YAAA,UAAU,EAAE,IALlB;AAMM,YAAA,MAAM,EAAE,CANd;AAOM,YAAA,QAAQ,EAAE,CAPhB;AAQM,YAAA,YAAY,EAAE,CARpB;AASM,YAAA,gBAAgB,EAAE,GATxB;AAUM,YAAA,eAAe,EAAE,GAVvB;AAWM,YAAA,IAAI,EAAE,KAAKiE,MAAL,CAAYnC,IAAZ,CAAiB,IAAjB,CAXZ;AAYM,YAAA,GAAG,EAAE,KAAKV;AAZhB;AAAA;AAAA;AAAA;AAAA,kBAXR;AAAA;AAAA;AAAA;AAAA;AAAA,gBALJ,eAiCI;AAAK,UAAA,SAAS,EAAE,kCAAhB;AAAA,kCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAU,YAAA,WAAW,EAAE,MAAvB;AAA+B,YAAA,QAAQ,EAAGY,CAAD,IAAO;AAAC,mBAAKpC,KAAL,CAAWQ,OAAX,CAAmBG,IAAnB,GAA0ByB,CAAC,CAACC,MAAF,CAASuB,KAAnC;AAAyC;AAA1F;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAjCJ,eAqCI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBArCJ,EAsCK,KAAK4B,cAAL,EAtCL,EAuCM,KAAKxF,KAAL,CAAWQ,OAAX,CAAmBI,MAAnB,CAA0B2B,MAA1B,GAAmC,EAAnC,iBAAyC;AAAQ,UAAA,SAAS,EAAE,oCAAnB;AAAyD,UAAA,OAAO,EAAE,KAAKuD,UAAL,CAAgB5D,IAAhB,CAAqB,IAArB,CAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAvC/C,eAyCI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAzCJ,eA0CI;AAAK,UAAA,SAAS,EAAE,kCAAhB;AAAA,kCACI;AAAO,YAAA,SAAS,EAAC,kBAAjB;AAAA,oCACI;AAAO,cAAA,IAAI,EAAC,UAAZ;AAAuB,cAAA,QAAQ,EAAGE,CAAD,IAAO;AAAC,qBAAKpC,KAAL,CAAWQ,OAAX,CAAmBQ,UAAnB,GAAiCoB,CAAC,CAACC,MAAF,CAASuB,KAAT,GAAiB,CAAjB,GAAqB,CAAtD;AAA0D,qBAAKQ,WAAL;AAAmB;AAAtH;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAM,cAAA,SAAS,EAAC;AAAhB;AAAA;AAAA;AAAA;AAAA,oBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALJ,EAOQ,KAAKpE,KAAL,CAAWQ,OAAX,CAAmBQ,UAAnB,KAAkC,CAAlC,iBACA;AAAK,YAAA,SAAS,EAAE,iCAAhB;AAAA,oCACI;AAAG,cAAA,KAAK,EAAE;AAAC4E,gBAAAA,OAAO,EAAE,OAAV;AAAmBsD,gBAAAA,MAAM,EAAE,kBAA3B;AAA+CC,gBAAAA,WAAW,EAAE;AAA5D,eAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,eAGI;AAAO,cAAA,IAAI,EAAE,MAAb;AAAqB,cAAA,WAAW,EAAE,KAAlC;AAAyC,cAAA,QAAQ,EAAG/G,CAAD,IAAO;AAAC,qBAAKpC,KAAL,CAAWQ,OAAX,CAAmBS,IAAnB,GAA0BmB,CAAC,CAACC,MAAF,CAASuB,KAAnC;AAAyC;AAApG;AAAA;AAAA;AAAA;AAAA,oBAHJ,eAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBARR;AAAA;AAAA;AAAA;AAAA;AAAA,gBA1CJ,eA4DI;AAAK,UAAA,SAAS,EAAE,kCAAhB;AAAA,kCACI;AAAO,YAAA,SAAS,EAAC,kBAAjB;AAAA,oCACI;AAAO,cAAA,IAAI,EAAC,UAAZ;AAAuB,cAAA,QAAQ,EAAGxB,CAAD,IAAO;AAAC,qBAAKpC,KAAL,CAAWQ,OAAX,CAAmBU,SAAnB,GAAgCkB,CAAC,CAACC,MAAF,CAASuB,KAAT,GAAiB,CAAjB,GAAqB,CAArD;AAAyD,qBAAKQ,WAAL;AAAmB;AAArH;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAM,cAAA,SAAS,EAAC;AAAhB;AAAA;AAAA;AAAA;AAAA,oBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALJ,EAOQ,KAAKpE,KAAL,CAAWQ,OAAX,CAAmBU,SAAnB,KAAiC,CAAjC,iBACA;AAAK,YAAA,KAAK,EAAE;AAACkI,cAAAA,KAAK,EAAE;AAAR,aAAZ;AAAoC,YAAA,SAAS,EAAE,oCAA/C;AAAA,oCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AACI,cAAA,EAAE,EAAE,0CADR;AAEI,cAAA,OAAO,EAAE,MAAM;AACX;AACI,uBAAK3G,QAAL,CAAc;AAACpC,oBAAAA,YAAY,EAAE;AAAf,mBAAd;AACH;AACJ,eANL;AAOI,cAAA,IAAI,EAAE,QAPV;AAQI,cAAA,KAAK,EAAE;AARX;AAAA;AAAA;AAAA;AAAA,oBAFJ,EAYK,KAAKL,KAAL,CAAWK,YAAX,iBAA2B,QAAC,YAAD;AAAc,cAAA,QAAQ,EAAG+B,CAAD,IAAO;AACvD,qBAAKkB,WAAL,CAAiBlB,CAAjB;AACH,eAF2B;AAEzB,cAAA,KAAK,EAAE,MAAM;AACZ,qBAAKK,QAAL,CAAc;AAACpC,kBAAAA,YAAY,EAAE;AAAf,iBAAd;AACH;AAJ2B;AAAA;AAAA;AAAA;AAAA,oBAZhC;AAAA;AAAA;AAAA;AAAA;AAAA,kBARR;AAAA;AAAA;AAAA;AAAA;AAAA,gBA5DJ,eAwFI;AAAK,UAAA,SAAS,EAAE,kCAAhB;AAAA,kCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,WAAD;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAxFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAJJ,eAkGI;AAAK,QAAA,SAAS,EAAE,gCAAhB;AAAA,+BACI;AAAQ,UAAA,OAAO,EAAE,KAAKsI,QAAL,CAAczG,IAAd,CAAmB,IAAnB,CAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cAlGJ;AAAA;AAAA;AAAA;AAAA;AAAA,YADC;AAwGR;;AA9eqD","sourcesContent":["import React, {memo, useMemo} from \"react\";\nimport '../styles/CreateLesson.css';\nimport Cropper from \"react-cropper\";\nimport 'cropperjs/dist/cropper.css';\nimport ReactQuill from \"react-quill\";\nimport 'react-quill/dist/quill.snow.css';\nimport Calendar_pop from \"./calendar_pop\";\nimport ShareLesson from \"./ShareLesson\";\nimport * as mime from 'react-native-mime-types';\n\nimport serverPath from \"../utilis/server-path\";\n\nimport loading_lesson from '../images/loading_lesson.svg'\n\nexport default class CreateLesson extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            UrlPath: 'skopiowane',\n            LoadingPop: true,\n            LessonCreated: true,\n            EditFile: false,\n            CalendarOpen: false,\n            BackgroundName: '',\n            AdditionalImages: [],\n            Content: {\n                Subject: '',\n                Image: '',\n                Desc: '',\n                Lesson: [\n                    {\n                        Text: '',\n                        Answer: 1,\n                        Files: [],\n                    }\n                ],\n                EnableCode: 0,\n                Code: '',\n                CanExpire: 0,\n                Expire: new Date().toLocaleDateString(),\n                Users: [],\n                Groups: []\n            }\n        }\n\n        this.cropref = React.createRef()\n\n        this.modules = {\n            toolbar: {\n                container: [\n                    [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n                    ['bold', 'italic', 'underline'],\n                    [{ 'list': 'ordered' }, { 'list': 'bullet' }],\n                    [{ 'align': [] }],\n                    ['link', 'image'],\n                    ['clean'],\n                    [{ 'color': [] }]\n                ],\n\n\n                // handlers: {\n                //     image: this.imageHandler,\n                // },\n            }\n        }\n    }\n\n\n    CopyURL() {\n        navigator.clipboard.writeText()\n    }\n\n    CreatingLessonPop() {\n        return (\n            <div className={'CreateLesson_creatingpop'}>\n                {!this.state.LessonCreated && <h2>Tworzenie lekcji, prosze czekać!</h2>}\n                {!this.state.LessonCreated && <img className={'CreateLesson_creatingpop_view_loading'} src={loading_lesson} alt={'loading'}/>}\n\n                {\n                    this.state.LessonCreated\n                        &&\n                    <div>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"\n                             className=\"CreateLesson_creatingpop_done_logo\" viewBox=\"0 0 16 16\">\n                            <path\n                                d=\"M2.5 8a5.5 5.5 0 0 1 8.25-4.764.5.5 0 0 0 .5-.866A6.5 6.5 0 1 0 14.5 8a.5.5 0 0 0-1 0 5.5 5.5 0 1 1-11 0z\"/>\n                            <path\n                                d=\"M15.354 3.354a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l7-7z\"/>\n                        </svg>\n                        <h2>Lekcja została utworzona pomyślnie!</h2>\n                        <fieldset onClick={this.CopyURL.bind(this)}>\n                            <legend>Adres URL lekcji</legend>\n                            <a>https://platforma.edukacyjna.pl/lesson?id=2202</a>\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"\n                                 className=\"bi bi-clipboard-check\" viewBox=\"0 0 16 16\">\n                                <path fill-rule=\"evenodd\"\n                                      d=\"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z\"/>\n                                <path\n                                    d=\"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z\"/>\n                                <path\n                                    d=\"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z\"/>\n                            </svg>\n                        </fieldset>\n                        <button>Stwórz nową lekcje</button>\n                    </div>\n                }\n\n            </div>\n        )\n    }\n\n    onSelectedFIle(e) {\n        if (e.target.files.length > 0) {\n            this.state.BackgroundName = e.target.files[0].name\n            this.setState({EditFile: true})\n            const reader = new FileReader()\n            reader.readAsDataURL(e.target.files[0])\n            reader.onload = (d) => {\n                const img = new Image()\n                img.src = d.target.result\n                img.onload = (c) => {\n                    this.cropref?.current.cropper.replace(c.target.src)\n                }\n            }\n        } else {\n            this.setState({EditFile: false})\n        }\n    }\n\n    ClickOnDate(time) {\n        // console.log(time)\n        time.setMonth(time.getMonth() + 1)\n        document.querySelector('#CreateLesson_main_view_expire_date_input')\n            .value = time.getFullYear() + '-' + (time.getMonth().toString().length === 1 ? '0' + time.getMonth() : time.getMonth()) + '-' + (time.getDate().toString().length === 1 ? '0' + time.getDate() : time.getDate())\n    }\n\n    RemoveChapter(id) {\n        if (this.state.Content.Lesson[id] !== undefined) {\n            this.state.Content.Lesson.splice(id , 1)\n            this.forceUpdate()\n        }\n    }\n\n    onCrop() {\n        function blobToFile(theBlob, fileName){\n            return new File([theBlob], fileName, { lastModified: new Date().getTime(), type: theBlob.type })\n        }\n        this.cropref.current.cropper.getCroppedCanvas().toBlob((e) => {this.state.Content.Image = blobToFile(e, this.state.BackgroundName);})\n    }\n\n    removeSelectedFile(chapter, ID) {\n        if (this.state.Content.Lesson[chapter] !== undefined &&  this.state.Content.Lesson[chapter].Files[ID] !== undefined) {\n            this.state.Content.Lesson[chapter].Files.splice(ID, 1)\n            this.forceUpdate()\n        }\n    }\n\n    renderFiles(id) {\n        const tas = []\n        for(let d = 0; d < this.state.Content.Lesson[id].Files.length; d++) {\n            tas.push(<div onClick={this.removeSelectedFile.bind(this, id, d)} className={'Dash_main_view_body_chapter_files_item Dash_main_view_body_chapter_files_item_close_bt '}>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"\n                     className=\"bi bi-file-arrow-down\" viewBox=\"0 0 16 16\">\n                    <path\n                        d=\"M8 5a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 9.293V5.5A.5.5 0 0 1 8 5z\"/>\n                    <path\n                        d=\"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z\"/>\n                </svg>\n                <div className={'Dash_main_view_body_chapter_files_item_text'}>\n                    <a style={{maxWidth: '50%'}}>\n                        {\n                            this.state.Content.Lesson[id].Files[d].name.substr(0, this.state.Content.Lesson[id].Files[d].name.lastIndexOf('.') + 1)\n                        }\n                    </a>\n                    <a>\n                        .\n                        {\n                            this.state.Content.Lesson[id].Files[d].name.substr(this.state.Content.Lesson[id].Files[d].name.lastIndexOf('.') + 1, this.state.Content.Lesson[id].Files[d].name.length)\n                        }\n                    </a>\n                    </div>\n\n                <svg className={'Dash_main_view_body_chapter_files_item_close'} xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"\n                     viewBox=\"0 0 16 16\">\n                    <path\n                        d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"/>\n                </svg>\n            </div>)\n            }\n        return tas\n    }\n\n    RenderChapters() {\n        const tab = []\n        for(let i = 0; i < this.state.Content.Lesson.length; i++) {\n            tab.push(<div className={'CreateLesson_main_view_body_text'}>\n                { (this.state.Content.Lesson.length > 1) && <h3>Rodział. {i + 1}</h3>}\n                <ReactQuill modules={this.modules} className={'CreateLesson_main_view_editor'} placeholder={'Zawartość lekcji'} onChange={(html) => {this.state.Content.Lesson[i].Text = html}}/>\n\n                {(this.state.Content.Lesson.length > 1) && <button className={'CreateLesson_main_view_body_remove_chapter'} onClick={this.RemoveChapter.bind(this, i)}>\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"\n                         className=\"bi bi-x\" viewBox=\"0 0 16 16\">\n                        <path\n                            d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"/>\n                    </svg>\n                    Usuń rozdział\n                </button>}\n\n                <div className={'CreateLesson_main_view_body_text_answer'}>\n                    <a style={{display: 'inline-block', marginTop: '15px'}}>Odpowiedz w formie:</a>\n                    <select onChange={(e) => {this.state.Content.Lesson[i].Answer = e.target.value}}>\n                        <option value={1}>tekstu</option>\n                        <option value={2}>pliku/ów</option>\n                        <option value={3}>pliku/ów i tekstu</option>\n                    </select>\n                    <label>\n                        Załacz pliki\n                        <input type={'file'} multiple style={{display: 'none'}} onChange={\n                            (e) => {\n                                this.state.Content.Lesson[i].Files = [...this.state.Content.Lesson[i].Files, ...e.target.files]\n                                this.forceUpdate()\n                            }\n                        }/>\n                    </label>\n                    <div className={'CreateLesson_main_view_body_text_answer_files'}>\n                        {\n                           this.renderFiles(i)\n                        }\n                    </div>\n                </div>\n            </div>)\n        }\n        return tab\n    }\n\n    addChapter() {\n        // console.log(this.state.Content.Lesson[0].Text)\n        if (this.state.Content.Lesson.length < 11) {\n            this.state.Content.Lesson.push({Text: '', Answer: 1, Files: []})\n            this.forceUpdate()\n        }\n    }\n\n    async sendFiles(index = 0) {\n        console.log(\"Zaczynam przesyłanie plików...\")\n        const form = new FormData()\n        for (let i = 0; i < this.state.Content.Lesson[index].Files.length; i++) {\n            form.append(this.state.Content.Lesson[index].Files[i].name, this.state.Content.Lesson[index].Files[i])\n        }\n        const resp = await fetch(serverPath() + \"api/Files/files.php\", {\n            method:\"POST\",\n            headers: {\n                'Access-Control-Allow-Origin':'*',\n                // 'Content-Type': 'multipart/form-data'\n            },\n            body: form,\n            credentials: 'include'\n        }).then(data => data.json()).catch(null)\n\n        if (resp == null) {\n            console.log('Błąd w przesyłaniu plików')\n        } else {\n            if (resp['CODE'] === 'OK') {\n                this.state.Content.Lesson[index].Files = resp['Files'].join('|')\n                console.log('Udało sie przesyłać pliki')\n            } else {\n                console.log('Błąd w przesyłaniu plików')\n            }\n        }\n    }\n\n    async ImageFromEditor(index) {\n        const dataURItoBlob = (dataURI) => {\n            // convert base64 to raw binary data held in a string\n            // doesn't handle URLEncoded DataURIs - see SO answer #6850276 for code that does this\n            var byteString = atob(dataURI.split(',')[1]);\n\n            // separate out the mime component\n            var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n\n            // write the bytes of the string to an ArrayBuffer\n            var ab = new ArrayBuffer(byteString.length);\n            var ia = new Uint8Array(ab);\n            for (var i = 0; i < byteString.length; i++) {\n                ia[i] = byteString.charCodeAt(i);\n            }\n\n            return new Blob([ab], {type: mimeString});\n        }\n\n        const blobToFile = (theBlob, fileName) => {\n            return new File([theBlob], fileName, { lastModified: new Date().getTime(), type: theBlob.type })\n        }\n\n        const sendData = async (Data) => {\n            return await fetch(serverPath() + \"/api/Files/ImageContent.php\", {\n                method:\"POST\",\n                headers: {\n                    'Access-Control-Allow-Origin':'*',\n                    // 'Content-Type': 'multipart/form-data'\n                },\n                body: Data,\n                credentials: 'include'\n            }).then(data => data.json()).catch(null)\n        }\n\n        if (this.state.Content.Lesson[index].Text.replaceAll(\" \", \"\") !== \"\") {\n            const htmlParser = document.createElement('body')\n            htmlParser.innerHTML = this.state.Content.Lesson[index].Text\n            const form = new FormData()\n            let iterator = 1\n            htmlParser.querySelectorAll('img').forEach((e) => {\n                e.id = iterator.toString() + '_image_' + new Date().getTime()\n                const file = dataURItoBlob(e.src)\n                form.append(e.id + '.' + mime.extension(file.type), blobToFile(file, e.id + '.' + mime.extension(file.type)))\n                e.id = e.id + '.' + mime.extension(file.type)\n                iterator += 1\n            })\n            await sendData(form).then((resp) => {\n                if (resp !== null) {\n                    if (resp['CODE'] === 'OK') {\n                        if (Object.keys(resp['Files']).length > 0) {\n                            htmlParser.querySelectorAll('img')\n                                .forEach((e) => {\n                                        e.src = serverPath() + 'api/Files' + resp['Files'][e.id]\n                                    }\n                                )\n                            this.state.Content.Lesson[index].Text = htmlParser.innerHTML\n                        }\n                    } else {\n                        console.log(\"Cos nie poszło z tym edytorem!\")\n                    }\n                }\n            })\n        }\n    }\n\n    async sendForm() {\n        // if is ok when post data\n        // console.log(this.state.Content.Lesson[0].Text)\n        if (this.state.Content.Image !== '') {\n            const form = new FormData()\n            form.append(this.state.Content.Image.name, this.state.Content.Image)\n            const resp = await fetch(\"http://192.168.0.7:8080/api/Files/ImageContent.php\", {\n                method:\"POST\",\n                headers: {\n                    'Access-Control-Allow-Origin':'*',\n                    // 'Content-Type': 'multipart/form-data'\n                },\n                body: form,\n                credentials: 'include'\n            }).then(data => data.json()).catch(null)\n            if (resp == null) {\n                console.log('Błąd w przesyłaniu plików')\n            } else {\n                if (resp['CODE'] === 'OK') {\n                    this.state.Content.Image = resp['Files'][this.state.Content.Image.name]\n                    console.log('Udało sie przesyłać pliki')\n                } else {\n                    console.log('Błąd w przesyłaniu plików')\n                }\n            }\n        }\n        for (let i = 0; i < this.state.Content.Lesson.length; i++) {\n            if (this.state.Content.Lesson[i].Files.length > 0) await this.sendFiles(i)\n            if (this.state.Content.Lesson[i].Text.length > 0) await this.ImageFromEditor(i)\n        }\n        try {\n            const resp = await fetch(serverPath() + \"api/Lessons/CreateLesson.php\", {\n                method: \"POST\",\n                headers: {\n                    'Access-Control-Allow-Origin':'*',\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(this.state.Content),\n                credentials: 'include'\n            }).then(data => data.json()).catch(null)\n\n            if (resp !== null) {\n                if (resp[\"CODE\"] === 'OK') {\n                    // window.sessionStorage.setItem('Token', resp['Token'])\n                    alert('Lesson created!')\n                    return true\n                } else {\n                    return false\n                }\n            } else return false;\n\n        } catch (e) {\n            return false\n        }\n    }\n\n    render() {\n        if (this.state.LoadingPop) return (\n            <div className={'CreateLesson_main_view'}>\n                <div className={'CreateLesson_main_view_header'}>\n                    <h1>Tworzenie lekcje</h1>\n                </div>\n                {this.CreatingLessonPop()}\n            </div>\n        )\n        else return(\n            <div className={'CreateLesson_main_view'}>\n                <div className={'CreateLesson_main_view_header'}>\n                    <h1>Tworzenie lekcje</h1>\n                </div>\n                <div className={'CreateLesson_main_view_body'}>\n                    <div style={{borderBottom: '1px solid #282c34'}} onClick={() => {document.querySelector('#subject_input').focus()}} className={'CreateLesson_main_view_body_text'}>\n                        <h2>Temat</h2>\n                        <input id={'subject_input'} type={'text'}  onChange={(e) => { this.state.Content.Subject = e.target.value }}/>\n                    </div>\n                    <div className={'CreateLesson_main_view_body_seletct_background'}>\n                        <a style={{display: 'inline-block', margin: '10px 0 0 0'}}>Ustaw zdjecie lekcji</a>\n                        <label className={'CreateLesson_main_view_select_image'}>\n                            <input type={'file'} style={{display: 'none'}} accept={'image/png, image/gif, image/jpeg'}\n                                   onChange={(e) => {\n                                       this.onSelectedFIle(e)\n                                   }}/>\n                            Wybierz\n                        </label>\n\n                        {this.state.EditFile &&\n                            <Cropper src={'https://wallpaperaccess.com/full/1916098.jpg'}\n                                  className={'CreateLesson_main_view_body_seletct_background_edit'}\n                                  aspectRatio={16 / 9}\n                                  guides={false}\n                                  checkCrossOrigin={false}\n                                  responsive={true}\n                                  scaleX={1}\n                                  viewMode={3}\n                                  autoCropArea={1}\n                                  minCropBoxHeight={100}\n                                  minCropBoxWidth={250}\n                                  crop={this.onCrop.bind(this)}\n                                  ref={this.cropref }\n                            />\n                        }\n\n                    </div>\n                    <div className={'CreateLesson_main_view_body_text'}>\n                        <a>Opis lekcji (Opcjonalne)</a>\n                        <textarea placeholder={'Opis'} onChange={(e) => {this.state.Content.Desc = e.target.value}}></textarea>\n                    </div>\n                    <h2>Zawartość lekcji</h2>\n                    {this.RenderChapters()}\n                    { this.state.Content.Lesson.length < 10 && <button className={'CreateLesson_main_view_add_chapter'} onClick={this.addChapter.bind(this)}>Dodaj\n                        rozdział</button>}\n                    <h2>Dostępność lekcji</h2>\n                    <div className={'CreateLesson_main_view_body_text'}>\n                        <label className=\"container_lesson\">\n                            <input type=\"checkbox\" onChange={(e) => {this.state.Content.EnableCode = (e.target.value ? 1 : 0); this.forceUpdate()}} />\n                            <span className=\"checkmark_lesson\"></span>\n                        </label>\n                        <a>Zabezpiecz dostęp do lekcje kodem</a>\n                        {\n                            this.state.Content.EnableCode === 1 &&\n                            <div className={'CreateLesson_main_view_PassCode'}>\n                                <a style={{display: 'block', margin: '0 10px 10px 10px', paddingLeft: '20px'}}>Aby wykonywać\n                                    daną lekcja trzeba najpierw podać ten kod.</a>\n                                <input type={'text'} placeholder={'Kod'} onChange={(e) => {this.state.Content.Code = e.target.value} }/>\n                                <button>\n                                    Generuj losowy kod\n                                </button>\n                            </div>\n                        }\n                    </div>\n                    <div className={'CreateLesson_main_view_body_text'}>\n                        <label className=\"container_lesson\">\n                            <input type=\"checkbox\" onChange={(e) => {this.state.Content.CanExpire = (e.target.value ? 1 : 0); this.forceUpdate()}} />\n                            <span className=\"checkmark_lesson\"></span>\n                        </label>\n                        <a>Ogranicz czasowo widocznośc lekcji</a>\n                        {\n                            this.state.Content.CanExpire === 1 &&\n                            <div style={{width: 'fit-content'}} className={'CreateLesson_main_view_expire_date'}>\n                                <a>Data po której lekcja nie będzie już widoczna</a>\n                                <input\n                                    id={'CreateLesson_main_view_expire_date_input'}\n                                    onClick={() => {\n                                        {\n                                            this.setState({CalendarOpen: true})\n                                        }\n                                    }}\n                                    type={'button'}\n                                    value={'2022-04-1'}\n                                />\n                                {this.state.CalendarOpen && <Calendar_pop onSelect={(e) => {\n                                    this.ClickOnDate(e)\n                                }} close={() => {\n                                    this.setState({CalendarOpen: false})\n                                }}/>}\n                            </div>\n                        }\n                    </div>\n                    <div className={'CreateLesson_main_view_body_text'}>\n                        <a>Przypisz użytkowników badź grupy do lekcji.</a>\n                        <ShareLesson/>\n                    </div>\n                </div>\n\n                <div className={'CreateLesson_main_view_summary'}>\n                    <button onClick={this.sendForm.bind(this)}>Stwórz</button>\n                </div>\n            </div>\n        )\n    }\n\n}"]},"metadata":{},"sourceType":"module"}