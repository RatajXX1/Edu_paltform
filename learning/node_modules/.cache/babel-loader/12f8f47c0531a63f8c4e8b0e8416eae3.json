{"ast":null,"code":"import _asyncToGenerator from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/regenerator/index.js\";import React from\"react\";import'../styles/Answers.css';import SimpleBar from\"simplebar-react\";import'simplebar/dist/simplebar.min.css';import logo from\"../images/user.jpg\";import serverPath from\"../utilis/server-path\";import parse from'html-react-parser';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Answers=/*#__PURE__*/function(_React$Component){_inherits(Answers,_React$Component);var _super=_createSuper(Answers);function Answers(props){var _this;_classCallCheck(this,Answers);_this=_super.call(this,props);_this.state={SeeAnswer:false,SeeAnswerID:0,LesID:0,Page:0,CanLoad:true,Content:[],AnswerView:{}};_this.initilizeParams();_this.StateNames={0:'',1:'Wysłane do poprawy',2:'Czeka na zweryfikowanie',3:'Zweryfikowana'};_this.onBottom=_this.onBottomEvent.bind(_assertThisInitialized(_this));return _this;}_createClass(Answers,[{key:\"initilizeParams\",value:function initilizeParams(){var params=new URLSearchParams(window.location.search);try{if(params.get(\"id\")!==undefined)this.state.LesID=parseInt(params.get('id'));else this.state.Error=true;}catch(e){this.state.Error=true;}}},{key:\"componentDidMount\",value:function componentDidMount(){this.GetData();if(this.props.scroll!==undefined&&this.props.scroll.current!==null){this.props.scroll.current.addEventListener('scroll',this.onBottom);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.props.scroll!==undefined&&this.props.scroll.current!==null){this.props.scroll.current.removeEventListener('scroll',this.onBottom);}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){if(this.props.scroll.current!==null){this.props.scroll.current.addEventListener('scroll',this.onBottom);this.props.scroll.current.addEventListener('scroll',this.onBottom);}}},{key:\"RefreshData\",value:function RefreshData(){this.setState({SeeAnswer:false,SeeAnswerID:0,LesID:0,Page:1,Content:[],AnswerView:{}});this.initilizeParams();this.GetData();}},{key:\"SetState\",value:function(){var _SetState=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(State){var resp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(serverPath()+\"api/Answers/setstate.php?ID=\".concat(this.state.SeeAnswerID,\"&state=\").concat(State),{method:'GET',headers:{'Access-Control-Allow-Origin':'*'},credentials:'include'}).then(function(r){return r.json();}).catch(null);case 3:resp=_context.sent;if(resp!==null){if(resp['CODE']==='OK'){// this.state.AnswerView = resp['Answer']\n// this.state.SeeAnswer = true\nthis.RefreshData();// alert(\"Zaktualizonwo stan\")\n}}_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}}},_callee,this,[[0,7]]);}));function SetState(_x){return _SetState.apply(this,arguments);}return SetState;}()},{key:\"onBottomEvent\",value:function onBottomEvent(e){if(e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight){if(this.state.CanLoad){this.state.Page+=1;this.getData();}}}},{key:\"GetData\",value:function(){var _GetData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var resp;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(serverPath()+\"api/Answers/?ID=\".concat(this.state.LesID,\"&page=\").concat(this.state.Page),{method:'GET',headers:{'Access-Control-Allow-Origin':'*'},credentials:'include'}).then(function(r){return r.json();}).catch(null);case 3:resp=_context2.sent;if(resp!==null){if(resp['CODE']==='OK'){this.state.Content=this.state.Content.concat(resp['Answers']);if(Object.entries(resp['Answers']).length>=25){this.state.CanLoad=true;}else this.state.CanLoad=false;this.forceUpdate();}}_context2.next=9;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);case 9:case\"end\":return _context2.stop();}}},_callee2,this,[[0,7]]);}));function GetData(){return _GetData.apply(this,arguments);}return GetData;}()},{key:\"GetAnswerData\",value:function(){var _GetAnswerData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(AnswerID){var resp;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(serverPath()+\"api/Answers/answer.php?ID=\".concat(AnswerID),{method:'GET',headers:{'Access-Control-Allow-Origin':'*'},credentials:'include'}).then(function(r){return r.json();}).catch(null);case 3:resp=_context3.sent;if(resp!==null){if(resp['CODE']==='OK'){this.state.AnswerView=resp['Answer'];this.state.SeeAnswerID=AnswerID;this.state.SeeAnswer=true;this.forceUpdate();}}_context3.next=9;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);case 9:case\"end\":return _context3.stop();}}},_callee3,this,[[0,7]]);}));function GetAnswerData(_x2){return _GetAnswerData.apply(this,arguments);}return GetAnswerData;}()},{key:\"SeeAnswer\",value:function SeeAnswer(){if(!this.state.SeeAnswer){this.state.SeeAnswer=true;this.forceUpdate();}else{this.state.SeeAnswer=false;this.forceUpdate();}}},{key:\"AnswerPop\",value:function AnswerPop(){var _this2=this;return/*#__PURE__*/_jsx(\"div\",{className:'Answers_main_view_pop_back',children:/*#__PURE__*/_jsxs(\"div\",{className:'Answers_main_view_pop_view',children:[/*#__PURE__*/_jsx(SimpleBar,{forceVisible:\"y\",autoHide:false,style:{width:'100%',maxHeight:'400px',overflowX:'hidden'},children:/*#__PURE__*/_jsxs(\"div\",{className:'Answers_main_view_pop_view_body',children:[/*#__PURE__*/_jsx(\"div\",{className:'Answers_main_view_pop_view_body_header',children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Odpowiedz U\\u017Cytkownika \",/*#__PURE__*/_jsx(\"b\",{children:this.state.AnswerView.Name+' '+this.state.AnswerView.Surrname}),\" na \",/*#__PURE__*/_jsxs(\"b\",{children:[\"Rodzia\\u0142 \",this.state.AnswerView.ContentChapter]})]})}),/*#__PURE__*/_jsx(\"h2\",{children:\"Odpowied\\u017A\"}),/*#__PURE__*/_jsx(\"div\",{children:parse(this.state.AnswerView.ContentText)}),this.state.AnswerView.ContentFiles.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Za\\u0142aczone pliki\"}),/*#__PURE__*/_jsx(\"div\",{className:'Answers_main_view_pop_view_body_files_Div',children:function(){var tab=[];var _loop=function _loop(i){tab.push(/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){window.open(serverPath()+'api/Files'+_this2.state.AnswerView.ContentFiles[i].FilePath,'_blank');},className:'Dash_main_view_body_chapter_files_item Dash_main_view_body_chapter_files_item_close_bt ',children:[/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",className:\"bi bi-file-arrow-down\",viewBox:\"0 0 16 16\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M8 5a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 9.293V5.5A.5.5 0 0 1 8 5z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:'Dash_main_view_body_chapter_files_item_text',children:[/*#__PURE__*/_jsx(\"a\",{style:{maxWidth:'50%'},children:_this2.state.AnswerView.ContentFiles[i].FileName.substr(0,_this2.state.AnswerView.ContentFiles[i].FileName.lastIndexOf('.')+1)}),/*#__PURE__*/_jsxs(\"a\",{children:[\".\",_this2.state.AnswerView.ContentFiles[i].FileName.substr(_this2.state.AnswerView.ContentFiles[i].FileName.lastIndexOf('.')+1,_this2.state.AnswerView.ContentFiles[i].FileName.length)]})]})]}));};for(var i=0;i<_this2.state.AnswerView.ContentFiles.length;i++){_loop(i);}return tab;}()})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:'Answers_main_view_pop_view_buttons',children:[/*#__PURE__*/_jsx(\"button\",{onClick:this.SeeAnswer.bind(this),children:\"Anuluj\"}),this.state.AnswerView.ContentState<3&&/*#__PURE__*/_jsx(\"button\",{onClick:this.SetState.bind(this,1),children:\"niezatwierdzaj\"}),this.state.AnswerView.ContentState<3&&/*#__PURE__*/_jsx(\"button\",{onClick:this.SetState.bind(this,3),children:\"Zatwierd\\u017A\"})]})]})});}},{key:\"renderData\",value:function renderData(){var tab=[];for(var i=0;i<this.state.Content.length;i++){tab.push(/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"a\",{children:this.state.Content[i].ContentChapter})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsxs(\"div\",{className:'User_list_view_mian_body_table_image_user',children:[/*#__PURE__*/_jsx(\"div\",{className:'User_list_view_mian_body_table_image_user_img',children:/*#__PURE__*/_jsx(\"img\",{src:logo})}),/*#__PURE__*/_jsx(\"a\",{children:this.state.Content[i].Name+' '+this.state.Content[i].Surrname})]})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"a\",{children:this.state.Content[i].ContentDate})}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"a\",{children:this.StateNames[this.state.Content[i].ContentState]})}),/*#__PURE__*/_jsx(\"th\",{children:this.state.Content[i].ContentState>1&&/*#__PURE__*/_jsx(\"button\",{onClick:this.GetAnswerData.bind(this,this.state.Content[i].ContentID),children:\"Zobacz\"})})]}));}return tab;}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:'Answers_main_view',children:[this.state.SeeAnswer&&this.AnswerPop(),/*#__PURE__*/_jsx(\"div\",{className:'Answers_main_view_headbar',children:/*#__PURE__*/_jsx(\"h1\",{children:\"Odpowiedzi\"})}),/*#__PURE__*/_jsx(\"div\",{className:'Answers_main_view_body',children:/*#__PURE__*/_jsxs(\"table\",{className:'Answers_main_view_body_table',children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{width:'5%',whiteSpace:'nowrap'},children:\"Rozdzia\\u0142\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Nazwa u\\u017Cytkownika\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'200px'},children:\"Data\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'250px'},children:\"Stan\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'200px'}})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[this.state.Content.length>0&&this.renderData(),this.state.Content.length===0&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"th\",{colSpan:'5',children:/*#__PURE__*/_jsx(\"h1\",{children:\"Brak wynik\\xF3w\"})})})]})]})})]});}}]);return Answers;}(React.Component);export{Answers as default};","map":{"version":3,"sources":["/Users/michalratajewski/edupage/files/learning/src/windows/Answers.js"],"names":["React","SimpleBar","logo","serverPath","parse","Answers","props","state","SeeAnswer","SeeAnswerID","LesID","Page","CanLoad","Content","AnswerView","initilizeParams","StateNames","onBottom","onBottomEvent","bind","params","URLSearchParams","window","location","search","get","undefined","parseInt","Error","e","GetData","scroll","current","addEventListener","removeEventListener","prevProps","prevState","snapshot","setState","State","fetch","method","headers","credentials","then","r","json","catch","resp","RefreshData","target","scrollHeight","scrollTop","clientHeight","getData","concat","Object","entries","length","forceUpdate","AnswerID","width","maxHeight","overflowX","Name","Surrname","ContentChapter","ContentText","ContentFiles","tab","i","push","open","FilePath","maxWidth","FileName","substr","lastIndexOf","ContentState","SetState","ContentDate","GetAnswerData","ContentID","AnswerPop","whiteSpace","renderData","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport '../styles/Answers.css';\nimport SimpleBar from \"simplebar-react\";\nimport 'simplebar/dist/simplebar.min.css';\nimport logo from \"../images/user.jpg\";\nimport serverPath from \"../utilis/server-path\";\nimport parse from 'html-react-parser';\n\nexport default class Answers extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            SeeAnswer: false,\n            SeeAnswerID: 0,\n            LesID: 0,\n            Page: 0,\n            CanLoad: true,\n            Content: [],\n            AnswerView: {\n\n            }\n        }\n        this.initilizeParams()\n\n        this.StateNames = {\n            0: '',\n            1: 'Wysłane do poprawy',\n            2: 'Czeka na zweryfikowanie',\n            3: 'Zweryfikowana',\n        }\n\n        this.onBottom = this.onBottomEvent.bind(this)\n\n    }\n\n    initilizeParams() {\n        const params = new URLSearchParams(window.location.search)\n        try {\n            if (params.get(\"id\") !== undefined) this.state.LesID = parseInt(params.get('id'))\n            else this.state.Error = true\n        } catch (e) {\n            this.state.Error = true\n        }\n    }\n\n    componentDidMount() {\n        this.GetData()\n        if (this.props.scroll !== undefined && this.props.scroll.current !== null) {\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.props.scroll !== undefined && this.props.scroll.current !== null) {\n            this.props.scroll.current.removeEventListener('scroll', this.onBottom)\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (this.props.scroll.current !== null\n        ) {\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n        }\n    }\n\n    RefreshData() {\n        this.setState(\n            {\n                SeeAnswer: false,\n                SeeAnswerID: 0,\n                LesID: 0,\n                Page: 1,\n                Content: [],\n                AnswerView: {}\n            }\n        )\n        this.initilizeParams()\n        this.GetData()\n    }\n\n    async SetState(State) {\n        try {\n            const resp = await fetch(\n                serverPath() + `api/Answers/setstate.php?ID=${this.state.SeeAnswerID}&state=${State}`,\n                {\n                    method: 'GET',\n                    headers: {\n                        'Access-Control-Allow-Origin': '*'\n                    },\n                    credentials: 'include'\n                }\n            ).then(r => r.json()).catch(null)\n\n            if (resp !== null) {\n                if (resp['CODE'] === 'OK') {\n                    // this.state.AnswerView = resp['Answer']\n                    // this.state.SeeAnswer = true\n                    this.RefreshData()\n                    // alert(\"Zaktualizonwo stan\")\n\n                }\n            }\n        } catch (e) {\n\n        }\n    }\n\n    onBottomEvent(e) {\n        if (e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight)\n        {\n            if (this.state.CanLoad) {\n                this.state.Page += 1\n                this.getData()\n            }\n        }\n    }\n\n    async GetData() {\n        try {\n            const resp = await fetch(\n                serverPath() + `api/Answers/?ID=${this.state.LesID}&page=${this.state.Page}`,\n                {\n                    method: 'GET',\n                    headers: {\n                        'Access-Control-Allow-Origin': '*'\n                    },\n                    credentials: 'include'\n                }\n            ).then(r => r.json()).catch(null)\n\n            if (resp !== null) {\n                if (resp['CODE'] === 'OK') {\n                    this.state.Content = this.state.Content.concat(resp['Answers'])\n                    if (Object.entries(resp['Answers']).length >= 25) {\n                        this.state.CanLoad = true\n                    } else this.state.CanLoad = false\n                    this.forceUpdate()\n                }\n            }\n        } catch (e) {\n\n        }\n    }\n\n    async GetAnswerData(AnswerID) {\n        try {\n            const resp = await fetch(\n                serverPath() + `api/Answers/answer.php?ID=${AnswerID}`,\n                {\n                    method: 'GET',\n                    headers: {\n                        'Access-Control-Allow-Origin': '*'\n                    },\n                    credentials: 'include'\n                }\n            ).then(r => r.json()).catch(null)\n\n            if (resp !== null) {\n                if (resp['CODE'] === 'OK') {\n                    this.state.AnswerView = resp['Answer']\n                    this.state.SeeAnswerID = AnswerID\n                    this.state.SeeAnswer = true\n                    this.forceUpdate()\n                }\n            }\n        } catch (e) {\n\n        }\n    }\n\n    SeeAnswer() {\n        if (!this.state.SeeAnswer) {\n            this.state.SeeAnswer = true\n            this.forceUpdate()\n        } else {\n            this.state.SeeAnswer = false\n            this.forceUpdate()\n        }\n    }\n\n    AnswerPop() {\n        return (\n            <div className={'Answers_main_view_pop_back'}>\n                <div className={'Answers_main_view_pop_view'}>\n                    <SimpleBar  forceVisible=\"y\"  autoHide={false} style={{width: '100%', maxHeight: '400px', overflowX: 'hidden'}}>\n                        <div className={'Answers_main_view_pop_view_body'}>\n                                <div className={'Answers_main_view_pop_view_body_header'}>\n                                    <p>Odpowiedz Użytkownika <b>{this.state.AnswerView.Name + ' ' + this.state.AnswerView.Surrname}</b> na <b>Rodział {this.state.AnswerView.ContentChapter}</b></p>\n                                </div>\n                                <h2>Odpowiedź</h2>\n                                <div>\n                                    {\n                                        parse(this.state.AnswerView.ContentText)\n                                    }\n                                </div>\n                            {\n                                this.state.AnswerView.ContentFiles.length > 0 &&\n                                <div>\n                                    <b>Załaczone pliki</b>\n                                    <div className={'Answers_main_view_pop_view_body_files_Div'}>\n                                        {(\n                                            () => {\n                                                const tab = []\n                                                for (let i = 0; i < this.state.AnswerView.ContentFiles.length; i++) {\n                                                    tab.push(\n                                                        <div onClick={() => {\n                                                            window.open(serverPath() + 'api/Files' + this.state.AnswerView.ContentFiles[i].FilePath, '_blank')\n                                                        }}\n                                                            className={'Dash_main_view_body_chapter_files_item Dash_main_view_body_chapter_files_item_close_bt '}>\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\"\n                                                                 height=\"16\"\n                                                                 className=\"bi bi-file-arrow-down\" viewBox=\"0 0 16 16\">\n                                                                <path\n                                                                    d=\"M8 5a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 9.293V5.5A.5.5 0 0 1 8 5z\"/>\n                                                                <path\n                                                                    d=\"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z\"/>\n                                                            </svg>\n                                                            <div\n                                                                className={'Dash_main_view_body_chapter_files_item_text'}>\n                                                                <a style={{maxWidth: '50%'}}>\n                                                                    {\n                                                                        this.state.AnswerView.ContentFiles[i].FileName.substr(0, this.state.AnswerView.ContentFiles[i].FileName.lastIndexOf('.') + 1)\n                                                                    }\n\n                                                                </a>\n                                                                <a>\n                                                                    .\n                                                                    {\n                                                                        this.state.AnswerView.ContentFiles[i].FileName.substr(this.state.AnswerView.ContentFiles[i].FileName.lastIndexOf('.') + 1, this.state.AnswerView.ContentFiles[i].FileName.length)\n                                                                    }\n                                                                </a>\n                                                            </div>\n                                                        </div>\n                                                    )\n                                                }\n                                                return tab\n                                            }\n                                        )()}\n                                    </div>\n                                </div>\n                            }\n                            </div>\n                        </SimpleBar>\n\n\n                    <div className={'Answers_main_view_pop_view_buttons'}>\n                        <button onClick={this.SeeAnswer.bind(this)}>\n                            Anuluj\n                        </button>\n                        {\n                            this.state.AnswerView.ContentState < 3 &&\n                            <button onClick={this.SetState.bind(this, 1)}>\n                                niezatwierdzaj\n                            </button>\n                        }\n                        {\n\n                            this.state.AnswerView.ContentState < 3 &&\n                            <button onClick={this.SetState.bind(this, 3)}>\n                                Zatwierdź\n                            </button>\n                        }\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    renderData() {\n        const tab = []\n        for (let i = 0; i < this.state.Content.length; i++) {\n            tab.push(\n                <tr>\n                    <th>\n                        <a>\n                            {\n                                this.state.Content[i].ContentChapter\n                            }\n                        </a>\n                    </th>\n                    <th>\n                        <div className={'User_list_view_mian_body_table_image_user'}>\n                            <div className={'User_list_view_mian_body_table_image_user_img'}>\n                                <img src={logo}/>\n                            </div>\n                            <a>\n                                {\n                                    this.state.Content[i].Name + ' ' + this.state.Content[i].Surrname\n                                }\n                            </a>\n                        </div>\n                    </th>\n                    <th>\n                        <a>\n                            {\n                                this.state.Content[i].ContentDate\n                            }\n                        </a>\n                    </th>\n                    <th>\n                        <a>\n                            {\n                                this.StateNames[this.state.Content[i].ContentState]\n                            }\n                        </a>\n                    </th>\n                    <th>\n                        {\n                            this.state.Content[i].ContentState > 1 && <button onClick={this.GetAnswerData.bind(this, this.state.Content[i].ContentID)}>\n                            Zobacz\n                        </button>}\n                    </th>\n                </tr>\n            )\n        }\n        return tab;\n    }\n\n    render() {\n        return (\n            <div className={'Answers_main_view'}>\n                {\n                    this.state.SeeAnswer && this.AnswerPop()\n                }\n                <div className={'Answers_main_view_headbar'}>\n                    <h1>Odpowiedzi</h1>\n                </div>\n                <div className={'Answers_main_view_body'}>\n                    <table className={'Answers_main_view_body_table'}>\n                        <thead>\n                        <tr >\n                            <th style={{width: '5%', whiteSpace: 'nowrap'}} >Rozdział</th>\n                            <th >Nazwa użytkownika</th>\n                            <th style={{width: '200px'}}>Data</th>\n                            <th style={{width: '250px'}}>Stan</th>\n                            <th style={{width: '200px'}}/>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        {\n                            this.state.Content.length > 0 && this.renderData()\n                        }\n                        {\n                            this.state.Content.length === 0 &&\n                            <tr>\n                                <th colSpan={'5'}>\n                                    <h1>\n                                        Brak wyników\n                                    </h1>\n                                </th>\n                            </tr>\n                        }\n                        </tbody>\n\n                    </table>\n                </div>\n            </div>\n        )\n    }\n\n}"]},"metadata":{},"sourceType":"module"}