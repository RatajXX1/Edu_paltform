{"ast":null,"code":"import _asyncToGenerator from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect}from\"react\";import'../styles/Lessons.css';import Lesson_widget from\"./lesson_widget\";import serverPath from\"../utilis/server-path\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Lessons=/*#__PURE__*/function(_React$Component){_inherits(Lessons,_React$Component);var _super=_createSuper(Lessons);function Lessons(props){var _this;_classCallCheck(this,Lessons);_this=_super.call(this,props);_this.state={Content:[],page:1,CanLoad:true};_this.onBottom=_this.onBottomEvent.bind(_assertThisInitialized(_this));return _this;}_createClass(Lessons,[{key:\"componentDidMount\",value:function componentDidMount(){this.getLesson();if(this.props.scroll!==undefined&&this.props.scroll.current!==null){this.props.scroll.current.addEventListener('scroll',this.onBottom);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.props.scroll!==undefined&&this.props.scroll.current!==null){// console.log('Unmount !!!!')\nthis.props.scroll.current.removeEventListener('scroll',this.onBottom);}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){if(this.props.scroll.current!==null){this.props.scroll.current.addEventListener('scroll',this.onBottom);this.props.scroll.current.addEventListener('scroll',this.onBottom);// this.forceUpdate()\n}}},{key:\"onBottomEvent\",value:function onBottomEvent(e){if(e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight){if(this.state.CanLoad){this.state.page+=1;this.getLesson();}}}},{key:\"getLesson\",value:function(){var _getLesson=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var resp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(serverPath()+'api/Lessons/AllLesson.php?page='+this.state.page.toString(),{method:'GET',headers:{'Access-Control-Allow-Origin':'*'},credentials:'include'}).then(function(e){return e.json();}).catch(null);case 3:resp=_context.sent;if(resp!==null){if(resp['CODE']==='OK'){this.state.Content=this.state.Content.concat(resp['Lessons']);this.forceUpdate();}else{this.state.CanLoad=false;}}_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}}},_callee,this,[[0,7]]);}));function getLesson(){return _getLesson.apply(this,arguments);}return getLesson;}()},{key:\"renderLessons\",value:function renderLessons(){var tab=[];if(this.state.Content.length>0)for(var i=0;i<this.state.Content.length;i++){tab.push(/*#__PURE__*/_jsx(Lesson_widget,{Image:this.state.Content[i].Image,Name:this.state.Content[i].Subject,ID:this.state.Content[i].ID}));}else tab.push(/*#__PURE__*/_jsx(\"h1\",{style:{userSelect:'none'},children:\"Brak wynik\\xF3w\"}));return tab;}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:'Dash_lessons_view',children:[/*#__PURE__*/_jsx(\"div\",{className:'Dash_lessons_view_header',children:/*#__PURE__*/_jsx(\"h2\",{children:\"Wszystkie lekcje\"})}),/*#__PURE__*/_jsx(\"div\",{className:'Dash_lessons_view_body',children:this.renderLessons()})]});}}]);return Lessons;}(React.Component);export default Lessons;","map":{"version":3,"sources":["/Users/michalratajewski/edupage/files/learning/src/windows/lessons.js"],"names":["React","useEffect","Lesson_widget","serverPath","Lessons","props","state","Content","page","CanLoad","onBottom","onBottomEvent","bind","getLesson","scroll","undefined","current","addEventListener","removeEventListener","prevProps","prevState","snapshot","e","target","scrollHeight","scrollTop","clientHeight","fetch","toString","method","headers","credentials","then","json","catch","resp","concat","forceUpdate","tab","length","i","push","Image","Subject","ID","userSelect","renderLessons","Component"],"mappings":"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","sourcesContent":["import React, {useEffect} from \"react\";\nimport '../styles/Lessons.css'\nimport Lesson_widget from \"./lesson_widget\";\nimport serverPath from \"../utilis/server-path\";\n\nclass Lessons extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            Content: [],\n            page: 1,\n            CanLoad: true\n        }\n\n        this.onBottom = this.onBottomEvent.bind(this)\n\n    }\n\n\n    componentDidMount() {\n        this.getLesson()\n        if (this.props.scroll !== undefined && this.props.scroll.current !== null) {\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n        }\n    }\n\n\n    componentWillUnmount() {\n        if (this.props.scroll !== undefined && this.props.scroll.current !== null) {\n            // console.log('Unmount !!!!')\n            this.props.scroll.current.removeEventListener('scroll', this.onBottom)\n\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (this.props.scroll.current !== null\n        ) {\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n            // this.forceUpdate()\n        }\n\n    }\n\n    onBottomEvent(e) {\n        if (e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight)\n        {\n            if (this.state.CanLoad) {\n                this.state.page += 1\n                this.getLesson()\n            }\n        }\n    }\n\n    async getLesson() {\n      try {\n\n          const resp = await fetch(\n               serverPath() + 'api/Lessons/AllLesson.php?page=' + this.state.page.toString(),\n              {\n                  method: 'GET',\n                  headers: {\n                      'Access-Control-Allow-Origin': '*'\n                  },\n                  credentials: 'include'\n              }\n          ).then(e => e.json()).catch(null)\n\n          if (resp !== null) {\n              if (resp['CODE'] === 'OK') {\n                  this.state.Content = this.state.Content.concat(resp['Lessons'])\n                  this.forceUpdate()\n              } else {\n                  this.state.CanLoad = false\n              }\n          }\n      } catch (e) {\n\n      }\n    }\n\n    renderLessons() {\n        const tab = []\n        if (this.state.Content.length > 0) for (let i = 0; i < this.state.Content.length; i++) {\n            tab.push(\n                <Lesson_widget Image={this.state.Content[i].Image} Name={this.state.Content[i].Subject} ID={this.state.Content[i].ID}/>\n            )\n        }\n        else tab.push(\n            <h1 style={{userSelect: 'none'}}>Brak wyników</h1>\n        )\n        return tab\n    }\n\n    render() {\n        return (\n            <div className={'Dash_lessons_view'}>\n                <div className={'Dash_lessons_view_header'}>\n                    <h2>Wszystkie lekcje</h2>\n                    {/*<button>*/}\n                    {/*    Sortuj*/}\n                    {/*    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"*/}\n                    {/*         className=\"bi bi-sort-down\" viewBox=\"0 0 16 16\">*/}\n                    {/*        <path*/}\n                    {/*            d=\"M3.5 2.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 11.293V2.5zm3.5 1a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zM7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1h-3zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z\"/>*/}\n                    {/*    </svg>*/}\n                    {/*</button>*/}\n                </div>\n                <div className={'Dash_lessons_view_body'}>\n                    {\n                        this.renderLessons()\n                    }\n                </div>\n            </div>\n        )\n    }\n\n}\n\nexport default Lessons;"]},"metadata":{},"sourceType":"module"}