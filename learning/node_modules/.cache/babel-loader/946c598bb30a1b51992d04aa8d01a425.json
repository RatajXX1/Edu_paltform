{"ast":null,"code":"import _asyncToGenerator from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/regenerator/index.js\";import crypto from\"./crypto\";import serverPath from\"./server-path\";export default{authorize:function authorize(login_input,password_input){var _arguments=arguments;return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var auto_login,resp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:auto_login=_arguments.length>2&&_arguments[2]!==undefined?_arguments[2]:false;_context.prev=1;_context.next=4;return crypto.sha256(password_input);case 4:password_input=_context.sent;_context.next=7;return fetch(serverPath()+'api/auth/login.php',{method:'POST',headers:{'Access-Control-Allow-Origin':'*','Content-Type':'application/json'},body:JSON.stringify({login:login_input,password:password_input,Auto_login:auto_login}),credentials:'include'}).then(function(data){return data.json();}).catch(null);case 7:resp=_context.sent;if(!(resp!==null)){_context.next=17;break;}if(!(resp[\"CODE\"]==='OK')){_context.next=14;break;}window.sessionStorage.setItem('Token',resp['Token']);return _context.abrupt(\"return\",true);case 14:return _context.abrupt(\"return\",false);case 15:_context.next=18;break;case 17:return _context.abrupt(\"return\",false);case 18:_context.next=24;break;case 20:_context.prev=20;_context.t0=_context[\"catch\"](1);console.log(_context.t0);return _context.abrupt(\"return\",false);case 24:case\"end\":return _context.stop();}}},_callee,null,[[1,20]]);}))();},register:function register(login_input,password_input,name_input,surrname_input){return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var resp;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return crypto.sha256(password_input);case 3:password_input=_context2.sent;_context2.next=6;return fetch(serverPath()+'api/auth/register.php',{method:'POST',headers:{'Access-Control-Allow-Origin':'*','Content-Type':'application/json'},body:JSON.stringify({Name:name_input,Surrname:surrname_input,login:login_input,password:password_input}),credentials:'include'}).then(function(data){return data.json();}).catch(null);case 6:resp=_context2.sent;if(!(resp!==null)){_context2.next=16;break;}if(!(resp[\"CODE\"]==='OK')){_context2.next=13;break;}window.sessionStorage.setItem('Token',resp['Token']);return _context2.abrupt(\"return\",true);case 13:return _context2.abrupt(\"return\",false);case 14:_context2.next=17;break;case 16:return _context2.abrupt(\"return\",false);case 17:_context2.next=22;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\",false);case 22:case\"end\":return _context2.stop();}}},_callee2,null,[[0,19]]);}))();},CheckAuthorize:function CheckAuthorize(){return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var resp;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(serverPath()+'api/auth/authorize.php',{method:'GET',headers:{'Access-Control-Allow-Origin':'*'},credentials:'include'}).then(function(data){return data.json();}).catch(null);case 3:resp=_context3.sent;if(!(resp!==null)){_context3.next=12;break;}if(!(resp['CODE']==='OK')){_context3.next=9;break;}return _context3.abrupt(\"return\",resp['DATA']);case 9:return _context3.abrupt(\"return\",null);case 10:_context3.next=13;break;case 12:return _context3.abrupt(\"return\",null);case 13:_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](0);return _context3.abrupt(\"return\",null);case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[0,15]]);}))();},isAuthorized:function isAuthorized(AuthorizedState){if(!AuthorizedState){if(window.location.pathname!=='/')window.location.href='/';}}};","map":{"version":3,"sources":["/Users/michalratajewski/edupage/files/learning/src/utilis/authorize.js"],"names":["crypto","serverPath","authorize","login_input","password_input","auto_login","sha256","fetch","method","headers","body","JSON","stringify","login","password","Auto_login","credentials","then","data","json","catch","resp","window","sessionStorage","setItem","console","log","register","name_input","surrname_input","Name","Surrname","CheckAuthorize","isAuthorized","AuthorizedState","location","pathname","href"],"mappings":"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","sourcesContent":["import crypto from \"./crypto\";\nimport serverPath from \"./server-path\";\n\nexport default {\n\n    async authorize(login_input, password_input, auto_login = false) {\n        try {\n            password_input = await crypto.sha256(password_input)\n            const resp = await fetch(serverPath() + 'api/auth/login.php', {\n                method: 'POST',\n                headers: {\n                    'Access-Control-Allow-Origin':'*',\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    login: login_input,\n                    password: password_input,\n                    Auto_login: auto_login\n                }),\n                credentials: 'include'\n            }).then(data => data.json()).catch(null)\n\n            if (resp !== null) {\n                if (resp[\"CODE\"] === 'OK') {\n                    window.sessionStorage.setItem('Token', resp['Token'])\n                    return true\n                } else {\n                    return false\n                }\n            } else return false;\n        } catch (e) {\n            console.log(e)\n            return false\n        }\n    },\n\n    async register(login_input, password_input, name_input, surrname_input) {\n        try {\n            password_input = await crypto.sha256(password_input)\n            const resp = await fetch(serverPath() + 'api/auth/register.php', {\n                method: 'POST',\n                headers: {\n                    'Access-Control-Allow-Origin':'*',\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    Name: name_input,\n                    Surrname: surrname_input,\n                    login: login_input,\n                    password: password_input,\n                }),\n                credentials: 'include'\n            }).then(data => data.json()).catch(null)\n\n            if (resp !== null) {\n                if (resp[\"CODE\"] === 'OK') {\n                    window.sessionStorage.setItem('Token', resp['Token'])\n                    return true\n                } else {\n                    return false\n                }\n            } else return false;\n        } catch (e) {\n            return false\n        }\n    },\n\n    async CheckAuthorize() {\n        try {\n            const resp = await fetch(serverPath() + 'api/auth/authorize.php', {\n                method: 'GET',\n                headers: {\n                    'Access-Control-Allow-Origin':'*'\n                },\n                credentials: 'include'\n            }).then(data => data.json()).catch(null)\n            if (resp !== null) {\n                if (resp['CODE'] === 'OK') {\n                    return resp['DATA']\n                } else return null\n            } else return null\n        } catch (e) {\n            return null\n        }\n    },\n\n    isAuthorized(AuthorizedState) {\n        if (!AuthorizedState) {\n            if (window.location.pathname !== '/') window.location.href = '/'\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}