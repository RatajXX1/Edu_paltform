{"ast":null,"code":"import _asyncToGenerator from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/Users/michalratajewski/edupage/files/learning/node_modules/@babel/runtime/regenerator/index.js\";import React from\"react\";import'../styles/Lessons.css';import Lesson_widget from\"./lesson_widget\";import serverPath from\"../utilis/server-path\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LessonGroup=/*#__PURE__*/function(_React$Component){_inherits(LessonGroup,_React$Component);var _super=_createSuper(LessonGroup);function LessonGroup(props){var _this;_classCallCheck(this,LessonGroup);_this=_super.call(this,props);_this.state={Content:[],page:1,CanLoad:true,GroupID:0};_this.onBottom=_this.onBottomEvent.bind(_assertThisInitialized(_this));return _this;}_createClass(LessonGroup,[{key:\"initilizeParams\",value:function initilizeParams(){var params=new URLSearchParams(window.location.search);try{if(params.get(\"ID\")!==undefined){this.state.GroupID=parseInt(params.get('ID'));this.GetData();}else this.state.CanLoad=false;}catch(e){this.state.CanLoad=false;}}},{key:\"componentDidMount\",value:function componentDidMount(){this.initilizeParams();if(this.props.scroll!==undefined&&this.props.scroll.current!==null){this.props.scroll.current.addEventListener('scroll',this.onBottom);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.props.scroll!==undefined&&this.props.scroll.current!==null){// console.log('Unmount !!!!')\nthis.props.scroll.current.removeEventListener('scroll',this.onBottom);}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){if(this.props.scroll.current!==null){this.props.scroll.current.addEventListener('scroll',this.onBottom);this.props.scroll.current.addEventListener('scroll',this.onBottom);// this.forceUpdate()\n}}},{key:\"onBottomEvent\",value:function onBottomEvent(e){if(e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight){if(this.state.CanLoad){this.state.page+=1;this.GetData();}}}},{key:\"GetData\",value:function(){var _GetData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var resp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(serverPath()+\"api/Lessons/?page=\".concat(this.state.page,\"&group=\").concat(this.state.GroupID),{method:'GET',headers:{'Access-Control-Allow-Origin':'*'},credentials:'include'}).then(function(e){return e.json();}).catch(null);case 3:resp=_context.sent;if(resp!==null){if(resp['CODE']==='OK'){this.state.Content=this.state.Content.concat(resp['Lessons']);this.forceUpdate();}else{this.state.CanLoad=false;}}_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}}},_callee,this,[[0,7]]);}));function GetData(){return _GetData.apply(this,arguments);}return GetData;}()},{key:\"renderLessons\",value:function renderLessons(){var tab=[];if(this.state.Content.length>0)for(var i=0;i<this.state.Content.length;i++){tab.push(/*#__PURE__*/_jsx(Lesson_widget,{Image:this.state.Content[i].Image,Name:this.state.Content[i].Subject,ID:this.state.Content[i].ID}));}else tab.push(/*#__PURE__*/_jsx(\"h1\",{style:{userSelect:'none'},children:\"Brak wynik\\xF3w\"}));return tab;}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:'Dash_lessons_view',children:[/*#__PURE__*/_jsx(\"div\",{className:'Dash_lessons_view_header',children:/*#__PURE__*/_jsx(\"h2\",{children:\"Wszystkie lekcje\"})}),/*#__PURE__*/_jsx(\"div\",{className:'Dash_lessons_view_body',children:this.renderLessons()})]});}}]);return LessonGroup;}(React.Component);export{LessonGroup as default};","map":{"version":3,"sources":["/Users/michalratajewski/edupage/files/learning/src/windows/LessonGroup.js"],"names":["React","Lesson_widget","serverPath","LessonGroup","props","state","Content","page","CanLoad","GroupID","onBottom","onBottomEvent","bind","params","URLSearchParams","window","location","search","get","undefined","parseInt","GetData","e","initilizeParams","scroll","current","addEventListener","removeEventListener","prevProps","prevState","snapshot","target","scrollHeight","scrollTop","clientHeight","fetch","method","headers","credentials","then","json","catch","resp","concat","forceUpdate","tab","length","i","push","Image","Subject","ID","userSelect","renderLessons","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport '../styles/Lessons.css'\nimport Lesson_widget from \"./lesson_widget\";\nimport serverPath from \"../utilis/server-path\";\n\n\nexport default class LessonGroup extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            Content: [],\n            page: 1,\n            CanLoad: true,\n            GroupID: 0,\n        }\n\n        this.onBottom = this.onBottomEvent.bind(this)\n\n    }\n\n    initilizeParams() {\n        const params = new URLSearchParams(window.location.search)\n        try {\n            if (params.get(\"ID\") !== undefined) {\n                this.state.GroupID = parseInt(params.get('ID'))\n                this.GetData()\n            }\n            else this.state.CanLoad = false\n        } catch (e) {\n            this.state.CanLoad = false\n        }\n    }\n\n    componentDidMount() {\n        this.initilizeParams()\n        if (this.props.scroll !== undefined && this.props.scroll.current !== null) {\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.props.scroll !== undefined && this.props.scroll.current !== null) {\n            // console.log('Unmount !!!!')\n            this.props.scroll.current.removeEventListener('scroll', this.onBottom)\n\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (this.props.scroll.current !== null\n        ) {\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n            this.props.scroll.current.addEventListener('scroll', this.onBottom)\n            // this.forceUpdate()\n        }\n\n    }\n\n    onBottomEvent(e) {\n        if (e.target.scrollHeight - e.target.scrollTop === e.target.clientHeight)\n        {\n            if (this.state.CanLoad) {\n                this.state.page += 1\n                this.GetData()\n            }\n        }\n    }\n\n    async GetData() {\n        try {\n            const resp = await fetch(\n                serverPath() + `api/Lessons/?page=${this.state.page}&group=${this.state.GroupID}`,\n                {\n                    method: 'GET',\n                    headers: {\n                        'Access-Control-Allow-Origin': '*'\n                    },\n                    credentials: 'include'\n                }\n            ).then(e => e.json()).catch(null)\n\n            if (resp !== null) {\n                if (resp['CODE'] === 'OK') {\n                    this.state.Content = this.state.Content.concat(resp['Lessons'])\n                    this.forceUpdate()\n                } else {\n                    this.state.CanLoad = false\n                }\n            }\n        } catch (e) {\n\n        }\n    }\n\n    renderLessons() {\n        const tab = []\n        if (this.state.Content.length > 0) for (let i = 0; i < this.state.Content.length; i++) {\n            tab.push(\n                <Lesson_widget Image={this.state.Content[i].Image} Name={this.state.Content[i].Subject} ID={this.state.Content[i].ID}/>\n            )\n        }\n        else tab.push(\n            <h1 style={{userSelect: 'none'}}>Brak wynik√≥w</h1>\n        )\n        return tab\n    }\n\n    render() {\n        return (\n            <div className={'Dash_lessons_view'}>\n                <div className={'Dash_lessons_view_header'}>\n                    <h2>Wszystkie lekcje</h2>\n\n                </div>\n                <div className={'Dash_lessons_view_body'}>\n                    {\n                        this.renderLessons()\n                    }\n                </div>\n            </div>\n        )\n    }\n\n}"]},"metadata":{},"sourceType":"module"}